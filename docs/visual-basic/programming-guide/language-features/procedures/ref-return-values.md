---
title: Başvuru dönüş değerleri (Visual Basic)
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: ba649c4beaf3ec70a8c118f823fe8f25651a05a7
ms.sourcegitcommit: 4621e67f69e7a9503ea93313ff60d69683207889
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/24/2018
ms.locfileid: "49995145"
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="e2cc6-102">Başvuru dönüş değerleri (Visual Basic) için destek</span><span class="sxs-lookup"><span data-stu-id="e2cc6-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="e2cc6-103">İle başlayarak C# 7.0 C# dili destekleyen *başvuru dönüş değerleri*.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="e2cc6-104">Başvuru dönüş değerleri anlamanın tek yolu, bir yönteme başvuru tarafından geçirilen bağımsız değişken karşıtı olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="e2cc6-105">Başvuruya göre geçirilen bağımsız değişken değiştirildiğinde değişiklikler çağrı üzerinde değişkeninin değeri yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="e2cc6-106">Başvuru dönüş değeri arayan tarafından yapılan değişiklikleri, bir yöntemi çağıran için bir başvuru dönüş değeri sağladığında, çağrılan yöntemin verilerinde yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="e2cc6-107">Visual Basic başvurusu Yazar yöntemleriyle size dönüş değerleri, ancak başvuru dönüş değerleri kullanmasına izin veriyor izin vermez.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="e2cc6-108">Diğer bir deyişle, başvuru dönüş değerine sahip bir yöntemi çağırabilir ve bu dönüş değerini değiştirin ve değişiklikleri başvuru dönüş değeri çağrılan yöntemin verileri yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="e2cc6-109">Başvuru dönüş değeri doğrudan değiştirme</span><span class="sxs-lookup"><span data-stu-id="e2cc6-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="e2cc6-110">Her zaman başarısız ve yok yöntemler için `ByRef` parametreleri, başvuru dönüş değeri doğrudan değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="e2cc6-111">Başvuru dönüş değeri döndüren ifadeler için yeni değer atayarak bunu yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span> 

<span data-ttu-id="e2cc6-112">Aşağıdaki C# örnek tanımlayan bir `NumericValue.IncrementValue` bir iç değeri artırır ve başvuru olarak döndüren bir yöntem dönüş değeri.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span> 

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="e2cc6-113">Başvuru dönüş değeri Visual Basic aşağıdaki örnekte çağıran tarafından değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="e2cc6-114">Unutmayın satırıyla `NumericValue.IncrementValue` yöntem çağrısı bir değer yönteme atamaz.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="e2cc6-115">Bunun yerine, yöntem tarafından döndürülen başvuru dönüş değeri için bir değer atar.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="e2cc6-116">Bir yardımcı yöntemi kullanarak</span><span class="sxs-lookup"><span data-stu-id="e2cc6-116">Using a helper method</span></span>

<span data-ttu-id="e2cc6-117">Diğer durumlarda, bir yöntem çağrısının başvuru dönüş değeri doğrudan değiştirme her zaman istenmeyebilir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="e2cc6-118">Örneğin, bir dize döndüren bir arama yöntemi bir eşleşme her zaman bulamayabilir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="e2cc6-119">Bu durumda, yalnızca arama başarılı olursa, başvuru dönüş değeri değiştirmek istediğiniz.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="e2cc6-120">Aşağıdaki C# örnekte, bu senaryo gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="e2cc6-121">Tanımladığı bir `Sentence` yazılmış sınıf C# içeren bir `FindNext` sonraki sözcüğe bulur, belirtilen bir alt dizesi ile başlayan bir cümle yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="e2cc6-122">Bir başvuru döndürmeyi olarak değer ve bir dize döndürülür `Boolean` yönteme başvuru tarafından geçirilen değişkeni arama başarılı olup olmadığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="e2cc6-123">Başvuru dönüş değeri, çağırana döndürülen değer yalnızca okunamıyor gösterir. isterse de değiştirebilirsiniz ve bu değişiklik, dahili olarak içinde yer alan verileri yansıtılır `Sentence` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-123">The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="e2cc6-124">Başvuru doğrudan değiştirme dönüş yöntem çağrısı bir eşleşme bulmak ve cümlede ilk sözcüğün döndürmek başarısız olabilir değer bu durumda güvenilir değildir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="e2cc6-125">Bu durumda, çağıranın yanlışlıkla cümlede ilk sözcüğün değiştirir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="e2cc6-126">Bunu engelleyen döndüren, çağıran tarafından bir `null` (veya `Nothing` Visual Basic'te).</span><span class="sxs-lookup"><span data-stu-id="e2cc6-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="e2cc6-127">Ancak bu durumda, değeri olan bir dize değiştirmeye `Nothing` oluşturur bir <xref:System.NullReferenceException>.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="e2cc6-128">Ayrıca döndüren, çağıran tarafından engellendi, <xref:System.String.Empty?displayProperty=nameWithType>, ancak bu çağrıyı değeri bir dize değişkeni tanımlamanızı gerektirir <xref:System.String.Empty?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="e2cc6-129">Çağıranın bu dizeyi değiştirebilirsiniz, ancak değiştirilen dize tarafından depolanan tümcedeki sözcükleri hiçbir ilişkisi olduğundan değişiklik herhangi bir amacı, hizmet `Sentence` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="e2cc6-130">Bu senaryonun işlenmesi için en iyi yolu, bir yardımcı yöntem başvuruya başvuru dönüş değeri geçirmektir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="e2cc6-131">Yardımcı yöntemi, ardından yöntem çağrısının başarılı olduğunu olsaydı, değiştirmek için başvuru dönen değer olup olmadığını ve belirlemek için mantığı içerir.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="e2cc6-132">Aşağıdaki örnekte, olası bir uygulamasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="e2cc6-133">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="e2cc6-133">See also</span></span>

<span data-ttu-id="e2cc6-134">[Bağımsız değişkenleri değere ve başvuruya göre geçirme](passing-arguments-by-value-and-by-reference.md) </span><span class="sxs-lookup"><span data-stu-id="e2cc6-134">[Passing arguments by value and by reference](passing-arguments-by-value-and-by-reference.md) </span></span>  
[<span data-ttu-id="e2cc6-135">Visual Basic'te Yordamlar</span><span class="sxs-lookup"><span data-stu-id="e2cc6-135">Procedures in Visual Basic</span></span>](index.md)   


