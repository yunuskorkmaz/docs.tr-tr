---
title: İşlem kapsamı kullanarak örtük işlem uygulama
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 49d1706a-1e0c-4c85-9704-75c908372eb9
ms.openlocfilehash: ae0c729444b3ccb154481e65a094d29d68541793
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54645853"
---
# <a name="implementing-an-implicit-transaction-using-transaction-scope"></a><span data-ttu-id="304d1-102">İşlem kapsamı kullanarak örtük işlem uygulama</span><span class="sxs-lookup"><span data-stu-id="304d1-102">Implementing an Implicit Transaction using Transaction Scope</span></span>
<span data-ttu-id="304d1-103"><xref:System.Transactions.TransactionScope> Sınıfı bir işlem ile etkileşime gerek kalmadan bir işlemde katılan olarak kod bloğu işaretlemek için basit bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="304d1-103">The <xref:System.Transactions.TransactionScope> class provides a simple way to mark a block of code as participating in a transaction, without requiring you to interact with the transaction itself.</span></span> <span data-ttu-id="304d1-104">İşlem kapsamı seçebilir ve ortam işlem otomatik olarak yönetir.</span><span class="sxs-lookup"><span data-stu-id="304d1-104">A transaction scope can select and manage the ambient transaction automatically.</span></span> <span data-ttu-id="304d1-105">Kendi kullanım kolaylığı ve verimliliği nedeniyle, kullanmanız önerilir <xref:System.Transactions.TransactionScope> sınıfı bir işlem uygulama geliştirirken.</span><span class="sxs-lookup"><span data-stu-id="304d1-105">Due to its ease of use and efficiency, it is recommended that you use the <xref:System.Transactions.TransactionScope> class when developing a transaction application.</span></span>  
  
 <span data-ttu-id="304d1-106">Ayrıca, işlem açıkça kaynaklarla listeleme gerekmez.</span><span class="sxs-lookup"><span data-stu-id="304d1-106">In addition, you do not need to enlist resources explicitly with the transaction.</span></span> <span data-ttu-id="304d1-107">Tüm <xref:System.Transactions> Kaynak Yöneticisi (örneğin, SQL Server 2005) kapsam tarafından oluşturulan bir ortam hareket varlığını algılayabilir ve otomatik olarak listeleme.</span><span class="sxs-lookup"><span data-stu-id="304d1-107">Any <xref:System.Transactions> resource manager (such as SQL Server 2005) can detect the existence of an ambient transaction created by the scope and automatically enlist.</span></span>  
  
## <a name="creating-a-transaction-scope"></a><span data-ttu-id="304d1-108">İşlem kapsamı oluşturma</span><span class="sxs-lookup"><span data-stu-id="304d1-108">Creating a transaction scope</span></span>  
 <span data-ttu-id="304d1-109">Aşağıdaki örnek, bir basit kullanımını gösterir <xref:System.Transactions.TransactionScope> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="304d1-109">The following sample shows a simple usage of the <xref:System.Transactions.TransactionScope> class.</span></span>  
  
 [!code-csharp[TransactionScope#1](../../../../samples/snippets/csharp/VS_Snippets_Remoting/TransactionScope/cs/ScopeWithSQL.cs#1)]
 [!code-vb[TransactionScope#1](../../../../samples/snippets/visualbasic/VS_Snippets_Remoting/TransactionScope/vb/ScopeWithSQL.vb#1)]  
  
 <span data-ttu-id="304d1-110">Yeni bir oluşturduktan sonra işlem kapsamı başlatılır <xref:System.Transactions.TransactionScope> nesne.</span><span class="sxs-lookup"><span data-stu-id="304d1-110">The transaction scope is started once you create a new <xref:System.Transactions.TransactionScope> object.</span></span>  <span data-ttu-id="304d1-111">Kod örneğinde gösterildiği gibi kapsamlar ile oluşturmanız önerilir bir **kullanarak** deyimi.</span><span class="sxs-lookup"><span data-stu-id="304d1-111">As illustrated in the code sample, it is recommended that you create scopes with a **using** statement.</span></span> <span data-ttu-id="304d1-112">**Kullanarak** deyimi kullanılabilir her ikisinde de C# ve Visual Basic ve gibi çalışır bir **try... finally** blok kapsamı, düzgün bir şekilde elden emin olmak için.</span><span class="sxs-lookup"><span data-stu-id="304d1-112">The **using** statement is available both in C# and in Visual Basic, and works like a **try...finally** block to ensure that the scope is disposed of properly.</span></span>  
  
 <span data-ttu-id="304d1-113">Ne zaman örneği <xref:System.Transactions.TransactionScope>, hareket yöneticisi katılmak için hangi işlem belirler.</span><span class="sxs-lookup"><span data-stu-id="304d1-113">When you instantiate <xref:System.Transactions.TransactionScope>, the transaction manager determines which transaction to participate in.</span></span> <span data-ttu-id="304d1-114">Belirlenen sonra kapsam her zaman bu harekete katılan.</span><span class="sxs-lookup"><span data-stu-id="304d1-114">Once determined, the scope always participates in that transaction.</span></span> <span data-ttu-id="304d1-115">Karar iki etkene dayanır: bir ortam işlem mevcut olup olmadığını ve değerini **TransactionScopeOption** oluşturucuda parametresi.</span><span class="sxs-lookup"><span data-stu-id="304d1-115">The decision is based on two factors: whether an ambient transaction is present and the value of the **TransactionScopeOption** parameter in the constructor.</span></span> <span data-ttu-id="304d1-116">Ortam işlem içinde kodunuzu yürütür işlem bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="304d1-116">The ambient transaction is the transaction within which your code executes.</span></span> <span data-ttu-id="304d1-117">Statik çağırarak bir başvuru ortam işlem edinebilirsiniz <xref:System.Transactions.Transaction.Current%2A?displayProperty=nameWithType> özelliği <xref:System.Transactions.Transaction> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="304d1-117">You can obtain a reference to the ambient transaction by calling the static <xref:System.Transactions.Transaction.Current%2A?displayProperty=nameWithType> property of the <xref:System.Transactions.Transaction> class.</span></span> <span data-ttu-id="304d1-118">Bu parametre nasıl kullanıldığı hakkında daha fazla bilgi için bkz: [işlem akışı TransactionScopeOption kullanarak yönetme](#ManageTxFlow) bu konudaki.</span><span class="sxs-lookup"><span data-stu-id="304d1-118">For more information on how this parameter is used, see the [Managing transaction flow using TransactionScopeOption](#ManageTxFlow) section of this topic.</span></span>  
  
## <a name="completing-a-transaction-scope"></a><span data-ttu-id="304d1-119">İşlem kapsamı Tamamlanıyor</span><span class="sxs-lookup"><span data-stu-id="304d1-119">Completing a transaction scope</span></span>  
 <span data-ttu-id="304d1-120">Uygulamanızı tüm iş tamamlandığında bir işlemde gerçekleştirmek istediği, çağırması gerekir <xref:System.Transactions.TransactionScope.Complete%2A?displayProperty=nameWIthType> hareketi tamamlamak için uygun olduğunu hareket yöneticisi bilgilendirmek için yalnızca bir kez yöntemi.</span><span class="sxs-lookup"><span data-stu-id="304d1-120">When your application completes all the work it wants to perform in a transaction, you should call the <xref:System.Transactions.TransactionScope.Complete%2A?displayProperty=nameWIthType> method only once to inform the transaction manager that it is acceptable to commit the transaction.</span></span> <span data-ttu-id="304d1-121">Çağrı yerleştirmek için çok iyi bir uygulamadır <xref:System.Transactions.TransactionScope.Complete%2A> son ifade olarak **kullanarak** blok.</span><span class="sxs-lookup"><span data-stu-id="304d1-121">It is very good practice to put the call to <xref:System.Transactions.TransactionScope.Complete%2A> as the last statement in the **using** block.</span></span>  
  
 <span data-ttu-id="304d1-122">Çünkü bu bir sistem hatası veya işlem kapsamında oluşturulan bir özel eşdeğer olarak yorumlar hareket yöneticisi bu yöntemini çağırmak başarısız olan işlemi durdurur.</span><span class="sxs-lookup"><span data-stu-id="304d1-122">Failing to call this method aborts the transaction, because the transaction manager interprets this as a system failure, or equivalent to an exception thrown within the scope of the transaction.</span></span> <span data-ttu-id="304d1-123">Ancak, bu yöntemi çağırmadan, işlem garanti etmez wil taahhüt.</span><span class="sxs-lookup"><span data-stu-id="304d1-123">However, calling this method does not guarantee that the transaction wil be committed.</span></span> <span data-ttu-id="304d1-124">İşlem Yöneticisi durumunuzu bildiren yalnızca bir yoludur.</span><span class="sxs-lookup"><span data-stu-id="304d1-124">It is merely a way of informing the transaction manager of your status.</span></span> <span data-ttu-id="304d1-125">Arama sonra <xref:System.Transactions.TransactionScope.Complete%2A> yöntemini kullanarak artık ortam işlem erişebilirsiniz <xref:System.Transactions.Transaction.Current%2A> özelliği ve bunu yapma girişimi oluşturulan bir özel durum neden olur.</span><span class="sxs-lookup"><span data-stu-id="304d1-125">After calling the <xref:System.Transactions.TransactionScope.Complete%2A> method, you can no longer access the ambient transaction by using the <xref:System.Transactions.Transaction.Current%2A> property, and attempting to do so will result in an exception being thrown.</span></span>  
  
 <span data-ttu-id="304d1-126">Varsa <xref:System.Transactions.TransactionScope> işlem başlangıçta oluşturulan işlem hareket yöneticisi tarafından Sistemi'ne gerçek işini gerçekleşir kodda son satırının sonra nesnesi **kullanarak** blok.</span><span class="sxs-lookup"><span data-stu-id="304d1-126">If the <xref:System.Transactions.TransactionScope> object created the transaction initially, the actual work of committing the transaction by the transaction manager occurs after the last line of code in the **using** block.</span></span> <span data-ttu-id="304d1-127">İşlem oluşturmadıysanız, yürütme zaman meydana gelir <xref:System.Transactions.CommittableTransaction.Commit%2A> sahibi tarafından çağrılır <xref:System.Transactions.CommittableTransaction> nesne.</span><span class="sxs-lookup"><span data-stu-id="304d1-127">If it did not create the transaction, the commit occurs whenever <xref:System.Transactions.CommittableTransaction.Commit%2A> is called by the owner of the <xref:System.Transactions.CommittableTransaction> object.</span></span> <span data-ttu-id="304d1-128">Bu noktada işlem yöneticisi kaynak yöneticileri çağırır ve yürütme veya geri alma, yoksa tabanlı bildiren <xref:System.Transactions.TransactionScope.Complete%2A> yöntemi çağrıldı <xref:System.Transactions.TransactionScope> nesne.</span><span class="sxs-lookup"><span data-stu-id="304d1-128">At that point the transaction manager calls the resource managers and informs them to either commit or rollback, based on whether the <xref:System.Transactions.TransactionScope.Complete%2A> method was called on the <xref:System.Transactions.TransactionScope> object.</span></span>  
  
 <span data-ttu-id="304d1-129">**Kullanarak** bildirimi sağlar <xref:System.Transactions.TransactionScope.Dispose%2A> yöntemi <xref:System.Transactions.TransactionScope> nesne bile özel bir durum oluştuğunda çağrılır.</span><span class="sxs-lookup"><span data-stu-id="304d1-129">The **using** statement ensures that the <xref:System.Transactions.TransactionScope.Dispose%2A> method of the <xref:System.Transactions.TransactionScope> object is called even if an exception occurs.</span></span> <span data-ttu-id="304d1-130"><xref:System.Transactions.TransactionScope.Dispose%2A> Yöntemi işlem kapsamı sonunu işaretler.</span><span class="sxs-lookup"><span data-stu-id="304d1-130">The <xref:System.Transactions.TransactionScope.Dispose%2A> method marks the end of the transaction scope.</span></span> <span data-ttu-id="304d1-131">Bu yöntemi çağrıldıktan sonra oluşan özel durumlarının işlem etkileyebilir değil.</span><span class="sxs-lookup"><span data-stu-id="304d1-131">Exceptions that occur after calling this method may not affect the transaction.</span></span> <span data-ttu-id="304d1-132">Bu yöntem aynı zamanda ortam işlem için önceki durumuna geri yükler.</span><span class="sxs-lookup"><span data-stu-id="304d1-132">This method also restores the ambient transaction to it previous state.</span></span>  
  
 <span data-ttu-id="304d1-133">A <xref:System.Transactions.TransactionAbortedException> işlem kapsamı oluşturur ve işlem iptal oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="304d1-133">A <xref:System.Transactions.TransactionAbortedException> is thrown if the scope creates the transaction, and the transaction is aborted.</span></span> <span data-ttu-id="304d1-134">A <xref:System.Transactions.TransactionInDoubtException> hareket yöneticisi tamamlama karar bağlanamazsa, oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="304d1-134">A <xref:System.Transactions.TransactionInDoubtException> is thrown if the transaction manager cannot reach a Commit decision.</span></span> <span data-ttu-id="304d1-135">İşlem, hiçbir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="304d1-135">No exception is thrown if the transaction is committed.</span></span>  
  
## <a name="rolling-back-a-transaction"></a><span data-ttu-id="304d1-136">Bir işlemi geri alınıyor</span><span class="sxs-lookup"><span data-stu-id="304d1-136">Rolling back a transaction</span></span>  
 <span data-ttu-id="304d1-137">Bir işlem geri almak istiyorsanız, değil, çağırmalıdır <xref:System.Transactions.TransactionScope.Complete%2A> işlem kapsamında yöntemi.</span><span class="sxs-lookup"><span data-stu-id="304d1-137">If you want to rollback a transaction, you should not call the <xref:System.Transactions.TransactionScope.Complete%2A> method within the transaction scope.</span></span> <span data-ttu-id="304d1-138">Örneğin, kapsam içinde bir özel durum.</span><span class="sxs-lookup"><span data-stu-id="304d1-138">For example, you can throw an exception within the scope.</span></span> <span data-ttu-id="304d1-139">İçinde yer aldığı işlem geri alınacaktır.</span><span class="sxs-lookup"><span data-stu-id="304d1-139">The transaction in which it participates in will be rolled back.</span></span>  
  
##  <a name="ManageTxFlow"></a> <span data-ttu-id="304d1-140">İşlem akışı TransactionScopeOption kullanarak yönetme</span><span class="sxs-lookup"><span data-stu-id="304d1-140">Managing transaction flow using TransactionScopeOption</span></span>  
 <span data-ttu-id="304d1-141">İşlem kapsamı kullanan bir yöntem çağrılarak iç içe geçirilemez bir <xref:System.Transactions.TransactionScope> gelen kendi kapsamı kullanan bir yöntem içinde olarak değil durumuyla `RootMethod` aşağıdaki örnekte, yöntemi</span><span class="sxs-lookup"><span data-stu-id="304d1-141">Transaction scope can be nested by calling a method that uses a <xref:System.Transactions.TransactionScope> from within a method that uses its own scope, as is the case with the `RootMethod` method in the following example,</span></span>  
  
```csharp  
void RootMethod()  
{  
     using(TransactionScope scope = new TransactionScope())  
     {  
          /* Perform transactional work here */  
          SomeMethod();  
          scope.Complete();  
     }  
}  
  
void SomeMethod()  
{  
     using(TransactionScope scope = new TransactionScope())  
     {  
          /* Perform transactional work here */  
          scope.Complete();  
     }  
}  
```  
  
 <span data-ttu-id="304d1-142">En üst işlem kapsamı kök kapsamı olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="304d1-142">The top-most transaction scope is referred to as the root scope.</span></span>  
  
 <span data-ttu-id="304d1-143"><xref:System.Transactions.TransactionScope> Sınıf türü numaralandırması kabul birden fazla aşırı yüklü oluşturucular sağlar <xref:System.Transactions.TransactionScopeOption>, kapsam işlem davranışını tanımlar.</span><span class="sxs-lookup"><span data-stu-id="304d1-143">The <xref:System.Transactions.TransactionScope> class provides several overloaded constructors that accept an enumeration of the type <xref:System.Transactions.TransactionScopeOption>, which defines the transactional behavior of the scope.</span></span>  
  
 <span data-ttu-id="304d1-144">Bir <xref:System.Transactions.TransactionScope> nesnenin üç seçenek vardır:</span><span class="sxs-lookup"><span data-stu-id="304d1-144">A <xref:System.Transactions.TransactionScope> object has three options:</span></span>  
  
-   <span data-ttu-id="304d1-145">Ortam işlem katılın veya bir mevcut değilse yeni bir tane oluşturun.</span><span class="sxs-lookup"><span data-stu-id="304d1-145">Join the ambient transaction, or create a new one if one does not exist.</span></span>  
  
-   <span data-ttu-id="304d1-146">Yeni bir kök kapsam, diğer bir deyişle, yeni bir hareket başlatır ve yeni bir ortam işlem kendi kapsam içinde olması bu işlem olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="304d1-146">Be a new root scope, that is, start a new transaction and have that transaction be the new ambient transaction inside its own scope.</span></span>  
  
-   <span data-ttu-id="304d1-147">Bir işlemde hiç katılmak değil.</span><span class="sxs-lookup"><span data-stu-id="304d1-147">Not take part in a transaction at all.</span></span> <span data-ttu-id="304d1-148">Sonuç olarak ortam hiçbir işlem yok.</span><span class="sxs-lookup"><span data-stu-id="304d1-148">There is no ambient transaction as a result.</span></span>  
  
 <span data-ttu-id="304d1-149">Kapsamı ile örneği varsa <xref:System.Transactions.TransactionScopeOption.Required>ve bir ortam işlem varsa, bu işlem kapsamı birleştirir.</span><span class="sxs-lookup"><span data-stu-id="304d1-149">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.Required>, and an ambient transaction is present, the scope joins that transaction.</span></span> <span data-ttu-id="304d1-150">Öte yandan, varsa, ortam hiçbir işlem, ardından kapsam yeni bir işlem oluşturur ve kök kapsam haline gelir.</span><span class="sxs-lookup"><span data-stu-id="304d1-150">If, on the other hand, there is no ambient transaction, then the scope creates a new transaction, and become the root scope.</span></span> <span data-ttu-id="304d1-151">Varsayılan değer budur.</span><span class="sxs-lookup"><span data-stu-id="304d1-151">This is the default value.</span></span> <span data-ttu-id="304d1-152">Zaman <xref:System.Transactions.TransactionScopeOption.Required> olan kullanıldığında, kapsam içinde kod kök olup farklı davranır gerekmez veya yalnızca ortam işlem katılma.</span><span class="sxs-lookup"><span data-stu-id="304d1-152">When <xref:System.Transactions.TransactionScopeOption.Required> is used, the code inside the scope does not need to behave differently whether it is the root or just joining the ambient transaction.</span></span> <span data-ttu-id="304d1-153">Her iki durumda da aynı şekilde çalışması.</span><span class="sxs-lookup"><span data-stu-id="304d1-153">It should operate identically in both cases.</span></span>  
  
 <span data-ttu-id="304d1-154">Kapsamı ile örneği varsa <xref:System.Transactions.TransactionScopeOption.RequiresNew>, her zaman bir kök kapsam olur.</span><span class="sxs-lookup"><span data-stu-id="304d1-154">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.RequiresNew>, it is always the root scope.</span></span> <span data-ttu-id="304d1-155">Yeni bir hareket başlatır ve yeni bir ortam işlem kapsam içinde kendi işlem olur.</span><span class="sxs-lookup"><span data-stu-id="304d1-155">It starts a new transaction, and its transaction becomes the new ambient transaction inside the scope.</span></span>  
  
 <span data-ttu-id="304d1-156">Kapsamı ile örneği varsa <xref:System.Transactions.TransactionScopeOption.Suppress>, hiçbir zaman bir işlemde bölümü alır, bakılmaksızın ortam bir işlem olup olmadığını yok.</span><span class="sxs-lookup"><span data-stu-id="304d1-156">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.Suppress>, it never takes part in a transaction, regardless of whether an ambient transaction is present.</span></span> <span data-ttu-id="304d1-157">Bu değeri her zaman örneği bir kapsama sahip **null** ortam kendi işlem olarak.</span><span class="sxs-lookup"><span data-stu-id="304d1-157">A scope instantiated with this value always have **null** as its ambient transaction.</span></span>  
  
 <span data-ttu-id="304d1-158">Yukarıdaki seçenekleri aşağıdaki tabloda özetlenmiştir.</span><span class="sxs-lookup"><span data-stu-id="304d1-158">The above options are summarized in the following table.</span></span>  
  
|<span data-ttu-id="304d1-159">TransactionScopeOption</span><span class="sxs-lookup"><span data-stu-id="304d1-159">TransactionScopeOption</span></span>|<span data-ttu-id="304d1-160">Ortam işlem</span><span class="sxs-lookup"><span data-stu-id="304d1-160">Ambient Transaction</span></span>|<span data-ttu-id="304d1-161">Kapsam bölümü alır</span><span class="sxs-lookup"><span data-stu-id="304d1-161">The scope takes part in</span></span>|  
|----------------------------|-------------------------|-----------------------------|  
|<span data-ttu-id="304d1-162">Gerekli</span><span class="sxs-lookup"><span data-stu-id="304d1-162">Required</span></span>|<span data-ttu-id="304d1-163">Hayır</span><span class="sxs-lookup"><span data-stu-id="304d1-163">No</span></span>|<span data-ttu-id="304d1-164">Yeni bir işlem (kök olacaktır)</span><span class="sxs-lookup"><span data-stu-id="304d1-164">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="304d1-165">Yeni gerektirir</span><span class="sxs-lookup"><span data-stu-id="304d1-165">Requires New</span></span>|<span data-ttu-id="304d1-166">Hayır</span><span class="sxs-lookup"><span data-stu-id="304d1-166">No</span></span>|<span data-ttu-id="304d1-167">Yeni bir işlem (kök olacaktır)</span><span class="sxs-lookup"><span data-stu-id="304d1-167">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="304d1-168">Önle</span><span class="sxs-lookup"><span data-stu-id="304d1-168">Suppress</span></span>|<span data-ttu-id="304d1-169">Hayır</span><span class="sxs-lookup"><span data-stu-id="304d1-169">No</span></span>|<span data-ttu-id="304d1-170">İşlem yok</span><span class="sxs-lookup"><span data-stu-id="304d1-170">No Transaction</span></span>|  
|<span data-ttu-id="304d1-171">Gerekli</span><span class="sxs-lookup"><span data-stu-id="304d1-171">Required</span></span>|<span data-ttu-id="304d1-172">Evet</span><span class="sxs-lookup"><span data-stu-id="304d1-172">Yes</span></span>|<span data-ttu-id="304d1-173">Ortam işlem</span><span class="sxs-lookup"><span data-stu-id="304d1-173">Ambient  Transaction</span></span>|  
|<span data-ttu-id="304d1-174">Yeni gerektirir</span><span class="sxs-lookup"><span data-stu-id="304d1-174">Requires New</span></span>|<span data-ttu-id="304d1-175">Evet</span><span class="sxs-lookup"><span data-stu-id="304d1-175">Yes</span></span>|<span data-ttu-id="304d1-176">Yeni bir işlem (kök olacaktır)</span><span class="sxs-lookup"><span data-stu-id="304d1-176">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="304d1-177">Önle</span><span class="sxs-lookup"><span data-stu-id="304d1-177">Suppress</span></span>|<span data-ttu-id="304d1-178">Evet</span><span class="sxs-lookup"><span data-stu-id="304d1-178">Yes</span></span>|<span data-ttu-id="304d1-179">İşlem yok</span><span class="sxs-lookup"><span data-stu-id="304d1-179">No Transaction</span></span>|  
  
 <span data-ttu-id="304d1-180">Olduğunda bir <xref:System.Transactions.TransactionScope> nesne birleştirir varolan bir ortam işlem kapsam nesnesinin elden değil sona erdi işlem sürece işlem kapsamı durdurur.</span><span class="sxs-lookup"><span data-stu-id="304d1-180">When a <xref:System.Transactions.TransactionScope> object joins an existing ambient transaction, disposing of the scope object may not end the transaction, unless the scope aborts the transaction.</span></span> <span data-ttu-id="304d1-181">Ortam işlem kök kapsam tarafından oluşturulmuş olsa bile, yalnızca, kök kapsam çıkarıldığından yok <xref:System.Transactions.CommittableTransaction.Commit%2A> işlem çağrılmadığı.</span><span class="sxs-lookup"><span data-stu-id="304d1-181">If the ambient transaction was created by a root scope, only when the root scope is disposed of, does <xref:System.Transactions.CommittableTransaction.Commit%2A> get called on the transaction.</span></span> <span data-ttu-id="304d1-182">İşlem el ile oluşturulmuş olsa bile, olduğunda ya da iptal veya oluşturucusu tarafından kaydedilen işlemi sonlandırır.</span><span class="sxs-lookup"><span data-stu-id="304d1-182">If the transaction was created manually, the transaction ends when it is either aborted, or committed by its creator.</span></span>  
  
 <span data-ttu-id="304d1-183">Aşağıdaki örnekte gösterildiği bir <xref:System.Transactions.TransactionScope> üç iç içe kapsamlı nesneler, farklı bir her örneklenen oluşturan nesne <xref:System.Transactions.TransactionScopeOption> değeri.</span><span class="sxs-lookup"><span data-stu-id="304d1-183">The following example shows a <xref:System.Transactions.TransactionScope> object that creates three nested scope objects, each instantiated with a different <xref:System.Transactions.TransactionScopeOption> value.</span></span>  
  
```csharp  
using(TransactionScope scope1 = new TransactionScope())   
//Default is Required   
{   
     using(TransactionScope scope2 = new   
      TransactionScope(TransactionScopeOption.Required))   
     {  
     ...  
     }   
  
     using(TransactionScope scope3 = new TransactionScope(TransactionScopeOption.RequiresNew))   
     {  
     ...  
     }   
  
     using(TransactionScope scope4 = new   
        TransactionScope(TransactionScopeOption.Suppress))   
    {  
     ...  
    }   
}  
```  
  
 <span data-ttu-id="304d1-184">Örnek kod bloğu yeni bir kapsam oluşturma ortam işlem gösterir (`scope1`) ile <xref:System.Transactions.TransactionScopeOption.Required>.</span><span class="sxs-lookup"><span data-stu-id="304d1-184">The example shows a code block without any ambient transaction creating a new scope (`scope1`) with <xref:System.Transactions.TransactionScopeOption.Required>.</span></span> <span data-ttu-id="304d1-185">Kapsam `scope1` (bir işlem) yeni bir işlem oluşturur ve işlem yapar gibi bir kök kapsamı olan ortam işlem.</span><span class="sxs-lookup"><span data-stu-id="304d1-185">The scope `scope1` is a root scope as it creates a new transaction (Transaction A) and makes Transaction A the ambient transaction.</span></span> <span data-ttu-id="304d1-186">`Scope1`Daha sonra her farklı bir ile üç daha fazla nesne oluşturur <xref:System.Transactions.TransactionScopeOption> değeri.</span><span class="sxs-lookup"><span data-stu-id="304d1-186">`Scope1` then creates three more objects, each with a different <xref:System.Transactions.TransactionScopeOption> value.</span></span> <span data-ttu-id="304d1-187">Örneğin, `scope2` ile oluşturulan <xref:System.Transactions.TransactionScopeOption.Required>, ve bir ortam işlem olduğundan, onu oluşturan ilk işlem birleştirir `scope1`.</span><span class="sxs-lookup"><span data-stu-id="304d1-187">For example, `scope2` is created with <xref:System.Transactions.TransactionScopeOption.Required>, and since there is an ambient transaction, it joins the first transaction created by `scope1`.</span></span> <span data-ttu-id="304d1-188">Unutmayın `scope3` yeni bir işlem ve kök kapsamı `scope4` ortam hiçbir işlem sahiptir.</span><span class="sxs-lookup"><span data-stu-id="304d1-188">Note that `scope3` is the root scope of a new transaction, and that `scope4` has no ambient transaction.</span></span>  
  
 <span data-ttu-id="304d1-189">Değerini varsayılan ve en sık kullanılan olsa da <xref:System.Transactions.TransactionScopeOption> olan <xref:System.Transactions.TransactionScopeOption.Required>, her diğer değerlerinin benzersiz amacı vardır.</span><span class="sxs-lookup"><span data-stu-id="304d1-189">Although the default and most commonly used value of <xref:System.Transactions.TransactionScopeOption> is <xref:System.Transactions.TransactionScopeOption.Required>, each of the other values has its unique purpose.</span></span>  
  
 <span data-ttu-id="304d1-190"><xref:System.Transactions.TransactionScopeOption.Suppress> kod bölümü tarafından gerçekleştirilen işlemleri korumak istediğiniz ve işlemleri başarısız olursa ortam işlemi durdurmak istiyor musunuz yararlı olur.</span><span class="sxs-lookup"><span data-stu-id="304d1-190"><xref:System.Transactions.TransactionScopeOption.Suppress> is useful when you want to preserve the operations performed by the code section, and do not want to abort the ambient transaction if the operations fail.</span></span> <span data-ttu-id="304d1-191">Örneğin, günlük gerçekleştirmek veya işlemlerini denetleme istediğinizde veya bağımsız olarak abonelere olayları yayımlamak istediğiniz olup ortam işleminizin tamamlar veya durdurur.</span><span class="sxs-lookup"><span data-stu-id="304d1-191">For example, when you want to perform logging or audit operations, or when you want to publish events to subscribers regardless of whether your ambient transaction commits or aborts.</span></span> <span data-ttu-id="304d1-192">Bu değer, aşağıdaki örnekte gösterildiği gibi bir işlem kapsam içinde bir işlem olmayan kod bölümünde sahip olmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="304d1-192">This value allows you to have a non-transactional code section inside a transaction scope, as shown in the following example.</span></span>  
  
```csharp  
using(TransactionScope scope1 = new TransactionScope())  
{  
     try  
     {  
          //Start of non-transactional section   
          using(TransactionScope scope2 = new  
             TransactionScope(TransactionScopeOption.Suppress))  
          {  
               //Do non-transactional work here  
          }  
          //Restores ambient transaction here  
   }  
     catch  
     {}  
   //Rest of scope1  
}  
```  
  
### <a name="voting-inside-a-nested-scope"></a><span data-ttu-id="304d1-193">İç içe bir kapsam içinde oylama</span><span class="sxs-lookup"><span data-stu-id="304d1-193">Voting inside a nested scope</span></span>  
 <span data-ttu-id="304d1-194">Kök kapsamın ortam işlem bir iç içe kapsamı katılabilir olsa da, çağırma <xref:System.Transactions.TransactionScope.Complete%2A> iç içe kapsam içinde kök kapsamına herhangi bir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="304d1-194">Although a nested scope can join the ambient transaction of the root scope, calling <xref:System.Transactions.TransactionScope.Complete%2A> in the nested scope has no affect on the root scope.</span></span> <span data-ttu-id="304d1-195">Yalnızca hareketi tamamlamak için son iç içe kapsam kök kapsam tüm kapsamlardan oy, işlem taahhüt olacaktır.</span><span class="sxs-lookup"><span data-stu-id="304d1-195">Only if all the scopes from the root scope down to the last nested scope vote to commit the transaction, will the transaction be committed.</span></span> <span data-ttu-id="304d1-196">Değil çağırma <xref:System.Transactions.TransactionScope.Complete%2A> hemen ortam işlem durdurulacak gibi bir iç içe kapsamda kök kapsam etkiler.</span><span class="sxs-lookup"><span data-stu-id="304d1-196">Not calling <xref:System.Transactions.TransactionScope.Complete%2A> in a nested scope will affect the root scope as the ambient transaction will immediately be aborted.</span></span>  
  
## <a name="setting-the-transactionscope-timeout"></a><span data-ttu-id="304d1-197">TransactionScope zaman aşımı ayarını</span><span class="sxs-lookup"><span data-stu-id="304d1-197">Setting the TransactionScope timeout</span></span>  
 <span data-ttu-id="304d1-198">Bazı aşırı yüklü oluşturucular <xref:System.Transactions.TransactionScope> türünde bir değer kabul <xref:System.TimeSpan>, işlem zaman aşımını denetlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="304d1-198">Some of the overloaded constructors of <xref:System.Transactions.TransactionScope> accept a value of type <xref:System.TimeSpan>, which is used to control the timeout of the transaction.</span></span> <span data-ttu-id="304d1-199">Sıfır olarak ayarlanmış bir zaman aşımı sonsuz bir zaman aşımı anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="304d1-199">A timeout set to zero means an infinite timeout.</span></span> <span data-ttu-id="304d1-200">Bir sorun iş mantığınızı, kod içerisinde ilerlemeye tarafından yalıtmak istediğiniz ve sorun bulmaya sırada zaman aşımı için hata ayıklama işlem istiyor musunuz sonsuz zaman aşımı çoğunlukla hata ayıklama için yararlı olur.</span><span class="sxs-lookup"><span data-stu-id="304d1-200">Infinite timeout is useful mostly for debugging, when you want to isolate a problem in your business logic by stepping through your code, and you do not want the transaction you debug to time out while you attempt to locate the problem.</span></span> <span data-ttu-id="304d1-201">Bu işlem kilitlenmeleri karşı koruma geçersiz kılar çünkü diğer durumlarda, sonsuz zaman aşımı değerini kullanarak son derece dikkatli olun.</span><span class="sxs-lookup"><span data-stu-id="304d1-201">Be extremely careful using the infinite timeout value in all other cases, because it overrides the safeguards against transaction deadlocks.</span></span>  
  
 <span data-ttu-id="304d1-202">Genellikle ayarlanabilir <xref:System.Transactions.TransactionScope> zaman aşımına uğramak üzere iki durumda da varsayılan dışındaki değerler.</span><span class="sxs-lookup"><span data-stu-id="304d1-202">You typically set the <xref:System.Transactions.TransactionScope> timeout to values other than default in two cases.</span></span> <span data-ttu-id="304d1-203">İlk uygulama işleyen durdurulan işlemleri şekilde test etmek istediğiniz geliştirme sırasında andır.</span><span class="sxs-lookup"><span data-stu-id="304d1-203">The first is during development, when you want to test the way your application handles aborted transactions.</span></span> <span data-ttu-id="304d1-204">Zaman aşımı (örneğin, bir milisaniye) küçük bir değere ayarlayarak, işlem başarısız olmasına neden ve bu nedenle hata işleme kodunu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="304d1-204">By setting the timeout to a small value (such as one millisecond), you cause your transaction to fail and can thus observe your error handling code.</span></span> <span data-ttu-id="304d1-205">Kapsam içinde kaynak talebi, söz konusu kilitlenmeleri kaynaklanan düşünüyorsanız, varsayılan zaman aşımı değerinden bir değere ayarlamanız ikinci durumdur.</span><span class="sxs-lookup"><span data-stu-id="304d1-205">The second case in which you set the value to be less than the default timeout is when you believe that the scope is involved in resource contention, resulting in deadlocks.</span></span> <span data-ttu-id="304d1-206">Bu durumda, işlem sürede durdurma ve varsayılan zaman aşımı sona bekleyin değil istediğiniz.</span><span class="sxs-lookup"><span data-stu-id="304d1-206">In that case, you want to abort the transaction as soon as possible and not wait for the default timeout to expire.</span></span>  
  
 <span data-ttu-id="304d1-207">Bir kapsam bir ortam işlem birleştirir halde ortam işlem ayarı daha küçük bir zaman aşımını belirtir, üzerinde yeni ve daha kısa zaman aşımı uygulanır <xref:System.Transactions.TransactionScope> nesnesi ve kapsam içinde iç içe belirlenen zaman bitmelidir veya işlem otomatik olarak durduruldu.</span><span class="sxs-lookup"><span data-stu-id="304d1-207">When a scope joins an ambient transaction but specifies a smaller timeout than the one the ambient transaction is set to, the new, shorter timeout is enforced on the <xref:System.Transactions.TransactionScope> object, and the scope must end within the nested time specified, or the transaction is automatically aborted.</span></span> <span data-ttu-id="304d1-208">İç içe kapsamın zaman aşımı, ortam işlem birden fazla ise, etkiye sahip değildir.</span><span class="sxs-lookup"><span data-stu-id="304d1-208">If the nested scope's timeout is more than that of the ambient transaction, it has no effect.</span></span>  
  
## <a name="setting-the-transactionscope-isolation-level"></a><span data-ttu-id="304d1-209">TransactionScope yalıtım düzeyi ayarlama</span><span class="sxs-lookup"><span data-stu-id="304d1-209">Setting the TransactionScope isolation level</span></span>  
 <span data-ttu-id="304d1-210">Bazı aşırı yüklü oluşturucular <xref:System.Transactions.TransactionScope> türünden bir yapıyı kabul <xref:System.Transactions.TransactionOptions> bir zaman aşımı değeri yanı sıra bir yalıtım düzeyi belirtmek için.</span><span class="sxs-lookup"><span data-stu-id="304d1-210">Some of the overloaded constructors of <xref:System.Transactions.TransactionScope> accept a structure of type <xref:System.Transactions.TransactionOptions> to specify an isolation level, in addition to a timeout value.</span></span> <span data-ttu-id="304d1-211">Varsayılan olarak, ile yalıtım düzeyi ayarlanan işlem yürütür <xref:System.Transactions.IsolationLevel.Serializable>.</span><span class="sxs-lookup"><span data-stu-id="304d1-211">By default, the transaction executes with isolation level set to <xref:System.Transactions.IsolationLevel.Serializable>.</span></span> <span data-ttu-id="304d1-212">Başka bir yalıtım düzeyi seçme <xref:System.Transactions.IsolationLevel.Serializable> yaygın olarak okuma yoğun sistemleri için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="304d1-212">Selecting an isolation level other than <xref:System.Transactions.IsolationLevel.Serializable> is commonly used for read-intensive systems.</span></span> <span data-ttu-id="304d1-213">Bu işlem teorik ve işlem semantiği, ilgili eşzamanlılık konuları ve sistem tutarlılık için sonuçlarıyla işleme düz bir anlayış gerektirir.</span><span class="sxs-lookup"><span data-stu-id="304d1-213">This requires a solid understanding of transaction processing theory and the semantics of the transaction itself, the concurrency issues involved, and the consequences for system consistency.</span></span>  
  
 <span data-ttu-id="304d1-214">Ayrıca, tüm kaynak yöneticileri yalıtım tüm düzeyleri desteği ve daha yüksek bir düzeyde yapılandırılmış bir işlemde katılmak bırakmayı.</span><span class="sxs-lookup"><span data-stu-id="304d1-214">In addition, not all resource managers support all levels of isolation, and they may elect to take part in the transaction at a higher level than the one configured.</span></span>  
  
 <span data-ttu-id="304d1-215">Her yalıtım düzeyi yanı sıra <xref:System.Transactions.IsolationLevel.Serializable> aynı bilgilerine erişmek diğer işlemlerden kaynaklanan tutarsızlık getiriyor.</span><span class="sxs-lookup"><span data-stu-id="304d1-215">Every isolation level besides <xref:System.Transactions.IsolationLevel.Serializable> is susceptible to inconsistency resulting from other transactions accessing the same information.</span></span> <span data-ttu-id="304d1-216">Farklı yalıtım düzeyleri arasındaki farkı biçiminde okunur ve yazma kilitler kullanılır.</span><span class="sxs-lookup"><span data-stu-id="304d1-216">The difference between the different isolation levels is in the way read and write locks are used.</span></span> <span data-ttu-id="304d1-217">Kilit yalnızca Veri Kaynağı Yöneticisi'nde işlem erişen veya hareket kaydedilmiş veya iptal kadar tutulması tutulur.</span><span class="sxs-lookup"><span data-stu-id="304d1-217">A lock can be held only when the transaction accesses the data in the resource manager, or it can be held until the transaction is committed or aborted.</span></span> <span data-ttu-id="304d1-218">Eski verimlilik, tutarlılık ikincisi için iyidir.</span><span class="sxs-lookup"><span data-stu-id="304d1-218">The former is better for throughput, the latter for consistency.</span></span> <span data-ttu-id="304d1-219">Kilit iki tür ve işlemleri (okuma/yazma) iki tür dört temel yalıtım düzeyi verin.</span><span class="sxs-lookup"><span data-stu-id="304d1-219">The two kinds of locks and the two kinds of operations (read/write) give four basic isolation levels.</span></span> <span data-ttu-id="304d1-220">Daha fazla bilgi edinmek için bkz. <xref:System.Transactions.IsolationLevel>.</span><span class="sxs-lookup"><span data-stu-id="304d1-220">See <xref:System.Transactions.IsolationLevel> for more information.</span></span>  
  
 <span data-ttu-id="304d1-221">Ne zaman kullanarak içe <xref:System.Transactions.TransactionScope> nesneleri, tüm iç içe kapsamları ortam işlem katılmaya istiyorsanız tam olarak aynı yalıtım düzeyi kullanmak üzere yapılandırılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="304d1-221">When using nested <xref:System.Transactions.TransactionScope> objects, all nested scopes must be configured to use exactly the same isolation level if they want to join the ambient transaction.</span></span> <span data-ttu-id="304d1-222">Bir iç içe varsa <xref:System.Transactions.TransactionScope> nesne çalışır bir farklı yalıtım düzeyini belirtir henüz ortam işlem katılmak bir <xref:System.ArgumentException> oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="304d1-222">If a nested <xref:System.Transactions.TransactionScope> object tries to join the ambient transaction yet it specifies a different isolation level, an <xref:System.ArgumentException> is thrown.</span></span>  
  
## <a name="interop-with-com"></a><span data-ttu-id="304d1-223">COM + ile birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="304d1-223">Interop with COM+</span></span>  
 <span data-ttu-id="304d1-224">Yeni bir oluşturduğunuzda <xref:System.Transactions.TransactionScope> kullanabileceğiniz örnek <xref:System.Transactions.EnterpriseServicesInteropOption> oluşturucular nasıl etkileşime COM + ile belirlemek için bir sabit listesi.</span><span class="sxs-lookup"><span data-stu-id="304d1-224">When you create a new <xref:System.Transactions.TransactionScope> instance, you can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration in one of the constructors to specify how to interact with COM+.</span></span> <span data-ttu-id="304d1-225">Bunun hakkında daha fazla bilgi için bkz. [Kurumsal Hizmetler ve COM + işlemleri ile birlikte çalışabilirlik](../../../../docs/framework/data/transactions/interoperability-with-enterprise-services-and-com-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="304d1-225">For more information on this, see [Interoperability with Enterprise Services and COM+ Transactions](../../../../docs/framework/data/transactions/interoperability-with-enterprise-services-and-com-transactions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="304d1-226">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="304d1-226">See also</span></span>
- <xref:System.Transactions.Transaction.Clone%2A>
- <xref:System.Transactions.TransactionScope>
