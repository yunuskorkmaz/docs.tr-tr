---
title: WPF Eklentilerine Genel Bakış
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 4fd8fe00fe6974bdcbf7b4af4da25150996de8c3
ms.sourcegitcommit: 24a4a8eb6d8cfe7b8549fb6d823076d7c697e0c6
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/23/2019
ms.locfileid: "68401701"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="8ca96-102">WPF Eklentilerine Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="8ca96-102">WPF Add-Ins Overview</span></span>

<a name="Introduction"></a><span data-ttu-id="8ca96-103">.NET Framework, geliştiricilerin eklenti genişletilebilirliği destekleyen uygulamalar oluşturmak için kullanabileceği bir eklenti modeli içerir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-103">The .NET Framework includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="8ca96-104">Bu eklenti modeli, uygulama işlevselliğini tümleştirmede ve genişlettirecek eklentilerin oluşturulmasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="8ca96-105">Bazı senaryolarda uygulamalar, eklentiler tarafından sunulan kullanıcı arabirimlerini de görüntülemesi gerekir. Bu konu başlığı altında, WPF 'in bu senaryoları etkinleştirmek için .NET Framework eklenti modelini nasıl genişlettiğini, arkasındaki mimariyi, avantajlarını ve onun sınırlamalarını gösterir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-105">In some scenarios, applications also need to display user interfaces that are provided by add-ins. This topic shows how WPF augments the .NET Framework add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>

<a name="Requirements"></a>

## <a name="prerequisites"></a><span data-ttu-id="8ca96-106">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="8ca96-106">Prerequisites</span></span>

<span data-ttu-id="8ca96-107">.NET Framework eklentisi modeliyle benzerlik gerekli.</span><span class="sxs-lookup"><span data-stu-id="8ca96-107">Familiarity with the .NET Framework add-in model is required.</span></span> <span data-ttu-id="8ca96-108">Daha fazla bilgi için bkz. eklentiler [ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="8ca96-108">For more information, see [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>

<a name="AddInsOverview"></a>

## <a name="add-ins-overview"></a><span data-ttu-id="8ca96-109">Eklentilere genel bakış</span><span class="sxs-lookup"><span data-stu-id="8ca96-109">Add-Ins Overview</span></span>

<span data-ttu-id="8ca96-110">Uygulama yeniden derleme ve yeni işlevsellik birleştirme için karmaşıklıklardan kaçınmak amacıyla, uygulamalar geliştiricilerin (birinci taraf ve üçüncü taraf), diğer uygulamaları oluşturmalarına olanak tanıyan genişletilebilirlik mekanizmaları uygular. bunlarla tümleştirin.</span><span class="sxs-lookup"><span data-stu-id="8ca96-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="8ca96-111">Bu tür genişletilebilirliği desteklemeye yönelik en yaygın yol, Eklentiler ("Eklentiler" ve "Eklentiler" olarak da bilinir) kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="8ca96-112">Eklentilerle genişletilebilirlik sunan gerçek dünya uygulamalarının örnekleri şunlardır:</span><span class="sxs-lookup"><span data-stu-id="8ca96-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>

- <span data-ttu-id="8ca96-113">Internet Explorer eklentileri.</span><span class="sxs-lookup"><span data-stu-id="8ca96-113">Internet Explorer add-ons.</span></span>

- <span data-ttu-id="8ca96-114">Windows Media Player eklentileri.</span><span class="sxs-lookup"><span data-stu-id="8ca96-114">Windows Media Player plug-ins.</span></span>

- <span data-ttu-id="8ca96-115">Visual Studio eklentileri.</span><span class="sxs-lookup"><span data-stu-id="8ca96-115">Visual Studio add-ins.</span></span>

<span data-ttu-id="8ca96-116">Örneğin, Windows Media Player eklenti modeli, üçüncü taraf geliştiricilerin Windows Media Player Windows tarafından desteklenmeyen medya biçimleri için kod çözücüleri ve kodlayıcıları oluşturma dahil olmak üzere çeşitli şekillerde genişletecek "Eklentiler" uygulamasına olanak tanır Media Player (örneğin, DVD, MP3), ses efektleri ve kaplamalar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="8ca96-117">Her eklenti modeli, bir uygulamaya özgü işlevselliği göstermek için oluşturulmuştur, ancak tüm eklenti modelleriyle ortak olan birkaç varlık ve davranış vardır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>

<span data-ttu-id="8ca96-118">Tipik eklenti genişletilebilirlik çözümlerinin üç ana varlığı *sözleşmeler*, *Eklentiler*ve *ana bilgisayar uygulamalarıdır*.</span><span class="sxs-lookup"><span data-stu-id="8ca96-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="8ca96-119">Sözleşmeler, eklentilerin ana bilgisayar uygulamalarıyla nasıl tümleştirileceğini iki şekilde tanımlar:</span><span class="sxs-lookup"><span data-stu-id="8ca96-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>

- <span data-ttu-id="8ca96-120">Eklentiler, ana bilgisayar uygulamaları tarafından uygulanan işlevlerle tümleştirilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>

- <span data-ttu-id="8ca96-121">Konak uygulamalar, ile tümleştirilecek eklentiler için işlevselliği kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-121">Host applications expose functionality for add-ins to integrate with.</span></span>

<span data-ttu-id="8ca96-122">Eklentilerin kullanılabilmesi için, ana bilgisayar uygulamalarının bunları bulması ve çalışma zamanında yüklemesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="8ca96-123">Sonuç olarak, eklentileri destekleyen uygulamalar aşağıdaki ek sorumluluklara sahiptir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>

- <span data-ttu-id="8ca96-124">**Bulma**: Konak uygulamaları tarafından desteklenen sözleşmelere bağlı olan eklentileri bulma.</span><span class="sxs-lookup"><span data-stu-id="8ca96-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>

- <span data-ttu-id="8ca96-125">**Etkinleştirme**: Eklentilerle iletişim yükleme, çalıştırma ve kurma.</span><span class="sxs-lookup"><span data-stu-id="8ca96-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>

- <span data-ttu-id="8ca96-126">**Yalıtım**: Uygulama etki alanlarını veya işlemlerini kullanarak, uygulamaları, eklentilerle ilgili olası güvenlik ve yürütme sorunlarından koruyan yalıtım sınırları oluşturmak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>

- <span data-ttu-id="8ca96-127">**İletişim**: Eklentilerin ve konak uygulamaların, yöntemleri çağırarak ve verileri geçirerek yalıtım sınırları genelinde birbirleriyle iletişim kurmasına izin verme.</span><span class="sxs-lookup"><span data-stu-id="8ca96-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>

- <span data-ttu-id="8ca96-128">**Ömür yönetimi**: Uygulama etki alanlarını ve süreçlerini temiz, öngörülebilir bir şekilde yükleme ve kaldırma (bkz. [uygulama etki alanları](../../app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="8ca96-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../app-domains/application-domains.md)).</span></span>

- <span data-ttu-id="8ca96-129">**Sürüm oluşturma**: Konak uygulamalarının ve eklentilerin, her birinin yeni sürümleri oluşturulduğunda iletişim kurabildiğinden emin olmak.</span><span class="sxs-lookup"><span data-stu-id="8ca96-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>

<span data-ttu-id="8ca96-130">Son olarak, güçlü bir eklenti modelinin geliştirilmesi, önemsiz olmayan bir zorunluluğudur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="8ca96-131">Bu nedenle .NET Framework, eklenti modelleri oluşturmak için bir altyapı sağlar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-131">For this reason, the .NET Framework provides an infrastructure for building add-in models.</span></span>

> [!NOTE]
> <span data-ttu-id="8ca96-132">Eklentiler hakkında daha ayrıntılı bilgi için bkz. eklentiler [ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="8ca96-132">For more detailed information on add-ins, see [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>

<a name="NETFrameworkAddInModelOverview"></a>

## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="8ca96-133">.NET Framework eklenti modeline genel bakış</span><span class="sxs-lookup"><span data-stu-id="8ca96-133">.NET Framework Add-In Model Overview</span></span>

<span data-ttu-id="8ca96-134"><xref:System.AddIn> Ad alanında bulunan .NET Framework eklenti modeli, eklenti genişletilebilirliği geliştirmeyi basitleştirmek için tasarlanan bir tür kümesi içerir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-134">The .NET Framework add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="8ca96-135">.NET Framework eklenti modelinin temel birimi, bir ana bilgisayar uygulamasının ve bir eklentinin birbirleriyle nasıl iletişim kuracağını tanımlayan *sözleşmedir*.</span><span class="sxs-lookup"><span data-stu-id="8ca96-135">The fundamental unit of the .NET Framework add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="8ca96-136">Bir sözleşme, sözleşmenin ana uygulamaya özgü *görünümünü* kullanarak bir konak uygulamasına sunulur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="8ca96-137">Benzer şekilde, sözleşmenin eklentiye özgü *görünümü* , eklentiye sunulur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="8ca96-138">Bir *Bağdaştırıcı* , bir konak uygulamasına ve bir eklentinin sözleşmenin ilgili görünümleri arasında iletişim kurmasına izin vermek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="8ca96-139">Sözleşmeler, görünümler ve bağdaştırıcılar segment olarak adlandırılır ve ilgili bir kesim kümesi bir işlem *hattı*oluşturur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="8ca96-140">İşlem hatları, .NET Framework eklentisi modelinin bulma, etkinleştirme, güvenlik yalıtımı, yürütme yalıtımı (hem uygulama etki alanları, hem de süreçler kullanılarak), iletişim, ömür yönetimi ve sürüm oluşturmayı desteklediği temelidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-140">Pipelines are the foundation upon which the .NET Framework add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>

<span data-ttu-id="8ca96-141">Bu desteğin toplamı, geliştiricilerin ana bilgisayar uygulamasının işlevselliğiyle tümleştirilen eklentiler oluşturmalarına olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="8ca96-142">Ancak, bazı senaryolarda konak uygulamalarının eklentiler tarafından belirtilen kullanıcı arabirimlerini görüntülemesi gerekir. .NET Framework her sunu teknolojisinin kullanıcı arabirimlerini uygulamak için kendi modeli olduğundan, .NET Framework eklenti modeli belirli bir sunum teknolojisini desteklemez.</span><span class="sxs-lookup"><span data-stu-id="8ca96-142">However, some scenarios require host applications to display user interfaces provided by add-ins. Because each presentation technology in the .NET Framework has its own model for implementing user interfaces, the .NET Framework add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="8ca96-143">Bunun yerine WPF, eklentiler için UI desteğiyle .NET Framework eklenti modelini genişletir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-143">Instead, WPF extends the .NET Framework add-in model with UI support for add-ins.</span></span>

<a name="WPFAddInModel"></a>

## <a name="wpf-add-ins"></a><span data-ttu-id="8ca96-144">WPF eklentileri</span><span class="sxs-lookup"><span data-stu-id="8ca96-144">WPF Add-Ins</span></span>

<span data-ttu-id="8ca96-145">WPF, .NET Framework eklentisi modeliyle birlikte, ana bilgisayar uygulamalarının eklentilerden kullanıcı arabirimlerini görüntülemesini gerektiren çok çeşitli senaryolara olanak tanır. Özellikle, bu senaryolar aşağıdaki iki programlama modeli ile WPF tarafından karşılanır:</span><span class="sxs-lookup"><span data-stu-id="8ca96-145">WPF, in conjunction with the .NET Framework add-in model, allows you to address a wide variety of scenarios that require host applications to display user interfaces from add-ins. In particular, these scenarios are addressed by WPF with the following two programming models:</span></span>

1. <span data-ttu-id="8ca96-146">**Eklenti bir kullanıcı arabirimi döndürür**.</span><span class="sxs-lookup"><span data-stu-id="8ca96-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="8ca96-147">Bir eklenti, anlaşma tarafından tanımlanan bir yöntem çağrısı aracılığıyla konak uygulamasına bir kullanıcı arabirimi döndürür.</span><span class="sxs-lookup"><span data-stu-id="8ca96-147">An add-in returns a UI to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="8ca96-148">Bu senaryo aşağıdaki durumlarda kullanılır:</span><span class="sxs-lookup"><span data-stu-id="8ca96-148">This scenario is used in the following cases:</span></span>

    - <span data-ttu-id="8ca96-149">Bir eklenti tarafından döndürülen bir kullanıcı arabiriminin görünümü, yalnızca çalışma zamanında bulunan, dinamik olarak oluşturulan raporlar gibi verilere veya koşullara bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-149">The appearance of a UI that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>

    - <span data-ttu-id="8ca96-150">Bir eklenti tarafından sunulan hizmetler için Kullanıcı arabirimi, eklentiyi kullanan konak uygulamalarının kullanıcı arabiriminden farklıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-150">The UI for services provided by an add-in differs from the UI of the host applications that can use the add-in.</span></span>

    - <span data-ttu-id="8ca96-151">Eklenti öncelikle konak uygulama için bir hizmet gerçekleştirir ve konak uygulamasına durumu bir kullanıcı arabirimi ile bildirir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-151">The add-in primarily performs a service for the host application, and reports status to the host application with a UI.</span></span>

2. <span data-ttu-id="8ca96-152">**Eklenti bir kullanıcı arabirimi**.</span><span class="sxs-lookup"><span data-stu-id="8ca96-152">**The add-in is a UI**.</span></span> <span data-ttu-id="8ca96-153">Bir eklenti, anlaşma tarafından tanımlanan bir UI 'dir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-153">An add-in is a UI, as defined by the contract.</span></span> <span data-ttu-id="8ca96-154">Bu senaryo aşağıdaki durumlarda kullanılır:</span><span class="sxs-lookup"><span data-stu-id="8ca96-154">This scenario is used in the following cases:</span></span>

    - <span data-ttu-id="8ca96-155">Bir eklenti, bir reklam gibi gösterilenden farklı hizmetler sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>

    - <span data-ttu-id="8ca96-156">Bir eklenti tarafından sunulan hizmetler için Kullanıcı arabirimi, hesap makinesi veya renk seçici gibi bu eklentiyi kullanan tüm konak uygulamaları için ortaktır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-156">The UI for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>

<span data-ttu-id="8ca96-157">Bu senaryolar, konak uygulama ve eklenti uygulama etki alanları arasında UI nesnelerinin geçirilmesini gerektirir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-157">These scenarios require that UI objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="8ca96-158">.NET Framework eklentisi modeli, uygulama etki alanları arasında iletişim kurmak için uzaktan iletişimi temel aldığından, aralarında geçen nesneler Uzaktan erişilebilir olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-158">Since the .NET Framework add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>

<span data-ttu-id="8ca96-159">Uzaktan erişilebilen bir nesne, aşağıdakilerden birini veya birkaçını yapan bir sınıfın örneğidir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-159">A remotable object is an instance of a class that does one or more of the following:</span></span>

- <span data-ttu-id="8ca96-160"><xref:System.MarshalByRefObject> Sınıfından türetilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>

- <span data-ttu-id="8ca96-161"><xref:System.Runtime.Serialization.ISerializable> Arabirimini uygular.</span><span class="sxs-lookup"><span data-stu-id="8ca96-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>

- <span data-ttu-id="8ca96-162"><xref:System.SerializableAttribute> Özniteliği uygulandı.</span><span class="sxs-lookup"><span data-stu-id="8ca96-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>

> [!NOTE]
> <span data-ttu-id="8ca96-163">Uzaktan erişilebilir .NET Framework nesnelerinin oluşturulmasıyla ilgili daha fazla bilgi için bkz. [nesneleri uzaktan](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))oluşturma.</span><span class="sxs-lookup"><span data-stu-id="8ca96-163">For more information regarding the creation of remotable .NET Framework objects, see [Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100)).</span></span>

<span data-ttu-id="8ca96-164">WPF Kullanıcı arabirimi türleri uzaktan erişilebilir değildir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-164">The WPF UI types are not remotable.</span></span> <span data-ttu-id="8ca96-165">WPF, sorunu çözmek için, eklentiler tarafından oluşturulan WPF Kullanıcı arabirimini konak uygulamalardan görüntülenmek üzere .NET Framework eklenti modelini genişletir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-165">To solve the problem, WPF extends the .NET Framework add-in model to enable WPF UI created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="8ca96-166">Bu destek WPF tarafından iki tür <xref:System.AddIn.Contract.INativeHandleContract> tarafından sağlanır: arabirimi ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters> sınıfı tarafından uygulanan iki statik yöntem: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="8ca96-166">This support is provided by WPF by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="8ca96-167">Yüksek düzeyde, bu türler ve yöntemler aşağıdaki şekilde kullanılır:</span><span class="sxs-lookup"><span data-stu-id="8ca96-167">At a high level, these types and methods are used in the following manner:</span></span>

1. <span data-ttu-id="8ca96-168">WPF, Eklentiler, denetimler, Kullanıcı denetimleri, düzen bölmeleri ve sayfalar gibi doğrudan ya da dolaylı <xref:System.Windows.FrameworkElement>olarak türetilmiş bir sınıf olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-168">WPF requires that user interfaces provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>

2. <span data-ttu-id="8ca96-169">Sözleşmenin, eklenti ile ana bilgisayar uygulaması arasında bir kullanıcı arabirimi geçirdiğini bildiren her yerde, bir <xref:System.AddIn.Contract.INativeHandleContract> ( <xref:System.Windows.FrameworkElement>değil) olarak bildirilmelidir; <xref:System.AddIn.Contract.INativeHandleContract> , yalıtım sınırları arasında geçirilebileceğini, eklenti Kullanıcı arabiriminin Uzaktan erişilebilir bir gösterimidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in UI that can be passed across isolation boundaries.</span></span>

3. <span data-ttu-id="8ca96-170">Eklentinin uygulama etki alanından geçirilmeden önce, bir <xref:System.Windows.FrameworkElement> , çağırarak <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>bir <xref:System.AddIn.Contract.INativeHandleContract> olarak paketlenmiştir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>

4. <span data-ttu-id="8ca96-171">Ana bilgisayar uygulamasının uygulama etki alanına geçtikten sonra, <xref:System.AddIn.Contract.INativeHandleContract> çağırarak <xref:System.Windows.FrameworkElement> <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>olarak yeniden paketlenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>

<span data-ttu-id="8ca96-172">, Ve kullanılması,<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> belirli senaryoya bağlıdır. <xref:System.AddIn.Contract.INativeHandleContract> <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A></span><span class="sxs-lookup"><span data-stu-id="8ca96-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="8ca96-173">Aşağıdaki bölümlerde her bir programlama modeli için ayrıntılar sağlanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-173">The following sections provide details for each programming model.</span></span>

<a name="ReturnUIFromAddInContract"></a>

## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="8ca96-174">Eklenti bir kullanıcı arabirimi döndürüyor</span><span class="sxs-lookup"><span data-stu-id="8ca96-174">Add-In Returns a User Interface</span></span>

<span data-ttu-id="8ca96-175">Bir eklentinin bir konak uygulamasına bir kullanıcı arabirimi döndürmesi için aşağıdakiler gereklidir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-175">For an add-in to return a UI to a host application, the following are required:</span></span>

1. <span data-ttu-id="8ca96-176">Ana bilgisayar uygulaması, eklenti ve işlem hattı, .NET Framework [eklentileri ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) belgelerinde açıklandığı şekilde oluşturulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-176">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>

2. <span data-ttu-id="8ca96-177">Sözleşmenin, bir Kullanıcı <xref:System.AddIn.Contract.IContract> arabirimi döndürmesi ve bir UI döndürmesi gerekir, sözleşmenin bir dönüş değeri türünde <xref:System.AddIn.Contract.INativeHandleContract>bir yöntem bildirmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a UI, the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>

3. <span data-ttu-id="8ca96-178">Eklenti ile konak uygulama arasında geçirilen kullanıcı arabirimi doğrudan veya dolaylı olarak türetilmiş <xref:System.Windows.FrameworkElement>olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-178">The UI that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>

4. <span data-ttu-id="8ca96-179">Eklentinin döndürdüğü Kullanıcı arabiriminin, yalıtım sınırını geçmeden <xref:System.Windows.FrameworkElement> <xref:System.AddIn.Contract.INativeHandleContract> önce bir öğesine dönüştürülmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-179">The UI that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>

5. <span data-ttu-id="8ca96-180">Döndürülen Kullanıcı arabiriminin, yalıtım sınırını geçtikten <xref:System.AddIn.Contract.INativeHandleContract> <xref:System.Windows.FrameworkElement> sonra bir öğesine dönüştürülmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-180">The UI that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>

6. <span data-ttu-id="8ca96-181">Ana bilgisayar uygulaması döndürülen <xref:System.Windows.FrameworkElement>öğesini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="8ca96-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>

<span data-ttu-id="8ca96-182">UI döndüren bir eklentinin nasıl uygulanacağını gösteren bir örnek için, bkz. [Kullanıcı arabirimi döndüren eklenti oluşturma](how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="8ca96-182">For an example that demonstrates how to implement an add-in that returns a UI, see [Create an Add-In That Returns a UI](how-to-create-an-add-in-that-returns-a-ui.md).</span></span>

<a name="AddInIsAUI"></a>

## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="8ca96-183">Eklenti bir kullanıcı arabirimidir</span><span class="sxs-lookup"><span data-stu-id="8ca96-183">Add-In Is a User Interface</span></span>

<span data-ttu-id="8ca96-184">Bir eklenti bir kullanıcı arabirimi olduğunda aşağıdakiler gereklidir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-184">When an add-in is a UI, the following are required:</span></span>

1. <span data-ttu-id="8ca96-185">Ana bilgisayar uygulaması, eklenti ve işlem hattı, .NET Framework [eklentileri ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) belgelerinde açıklandığı şekilde oluşturulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-185">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>

2. <span data-ttu-id="8ca96-186">Eklentiye ait sözleşme arabiriminin uygulanması <xref:System.AddIn.Contract.INativeHandleContract>gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>

3. <span data-ttu-id="8ca96-187">Konak uygulamasına geçirilen eklenti doğrudan veya dolaylı olarak türetilmiş <xref:System.Windows.FrameworkElement>olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>

4. <span data-ttu-id="8ca96-188">Eklenti, yalıtım sınırını geçmeden <xref:System.Windows.FrameworkElement> <xref:System.AddIn.Contract.INativeHandleContract> önce bir öğesinden öğesine dönüştürülmelidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>

5. <span data-ttu-id="8ca96-189">Bu eklenti, yalıtım sınırını geçtikten <xref:System.AddIn.Contract.INativeHandleContract> <xref:System.Windows.FrameworkElement> sonra bir öğesinden öğesine dönüştürülmelidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>

6. <span data-ttu-id="8ca96-190">Ana bilgisayar uygulaması döndürülen <xref:System.Windows.FrameworkElement>öğesini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="8ca96-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>

<span data-ttu-id="8ca96-191">Kullanıcı arabirimi olan bir eklentinin nasıl uygulanacağını gösteren bir örnek için, bkz. [UI olan eklenti oluşturma](how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="8ca96-191">For an example that demonstrates how to implement an add-in that is a UI, see [Create an Add-In That Is a UI](how-to-create-an-add-in-that-is-a-ui.md).</span></span>

<a name="ReturningMultipleUIsFromAnAddIn"></a>

## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="8ca96-192">Bir eklentiden birden çok Uıto döndürme</span><span class="sxs-lookup"><span data-stu-id="8ca96-192">Returning Multiple UIs from an Add-In</span></span>

<span data-ttu-id="8ca96-193">Eklentiler, ana bilgisayar uygulamalarının görüntülemesi için genellikle birden çok kullanıcı arabirimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-193">Add-ins often provide multiple user interfaces for host applications to display.</span></span> <span data-ttu-id="8ca96-194">Örneğin, bir kullanıcı arabirimi olarak da konak uygulamasına durum bilgilerini sağlayan bir kullanıcı arabirimi olan bir eklentiyi düşünün.</span><span class="sxs-lookup"><span data-stu-id="8ca96-194">For example, consider an add-in that is a UI that also provides status information to the host application, also as a UI.</span></span> <span data-ttu-id="8ca96-195">Bu gibi bir eklenti, her iki eklentinin de bir [Kullanıcı arabirimi döndürür](#ReturnUIFromAddInContract) ve [eklenti bir kullanıcı arabirimi](#AddInIsAUI) modelleridir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>

<a name="AddInsAndXBAPs"></a>

## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="8ca96-196">Eklentiler ve XAML tarayıcı uygulamaları</span><span class="sxs-lookup"><span data-stu-id="8ca96-196">Add-Ins and XAML Browser Applications</span></span>

<span data-ttu-id="8ca96-197">Bu örnekte, ana bilgisayar uygulaması yüklenmiş bir tek başına uygulamadır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="8ca96-198">Ancak [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] , aşağıdaki ek derleme ve uygulama gereksinimleriyle birlikte eklentileri de barındırabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="8ca96-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>

- <span data-ttu-id="8ca96-199">Uygulama bildirimi, işlem hattını (klasörler ve derlemeler) ve eklenti derlemesini istemci makinedeki ClickOnce uygulama önbelleğine, ile aynı klasöre [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]indirmek için özel olarak yapılandırılmalıdır. [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</span><span class="sxs-lookup"><span data-stu-id="8ca96-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the ClickOnce application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>

- <span data-ttu-id="8ca96-200">Eklentilerin keşfedilmesine ve yüklenmesine yönelik [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kodun,işlemhattıveeklentikonumugibiClickOnceuygulamaönbelleğinikullanmasıgerekir.[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]</span><span class="sxs-lookup"><span data-stu-id="8ca96-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the ClickOnce application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>

- <span data-ttu-id="8ca96-201">Eklenti, kaynak sitesinde bulunan gevşek dosyalara başvuruyorsa, eklentileri özel bir güvenlik bağlamına yüklemesi [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] gerekir;tarafındanbarındırıldığındaeklentileryalnızcaanabilgisayaruygulamasınınsitesindebulunangevşekdosyalarabaşvurabilir[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kaynak.</span><span class="sxs-lookup"><span data-stu-id="8ca96-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>

<span data-ttu-id="8ca96-202">Bu görevler, aşağıdaki alt bölümlerde ayrıntılı olarak açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-202">These tasks are described in detail in the following subsections.</span></span>

### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="8ca96-203">ClickOnce dağıtımı için işlem hattı ve eklentiyi yapılandırma</span><span class="sxs-lookup"><span data-stu-id="8ca96-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>

[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="8ca96-204">ClickOnce dağıtım önbelleğindeki güvenli bir klasöre indirilir ve buradan çalıştırılır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-204">are downloaded to and run from a safe folder in the ClickOnce deployment cache.</span></span> <span data-ttu-id="8ca96-205">Bir [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] eklentinin barındırmasını sağlamak için, işlem hattı ve eklenti derlemesi güvenli klasöre de indirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="8ca96-206">Bunu başarmak için, uygulama bildirimini indirmek üzere hem işlem hattı hem de eklenti derlemesini içerecek şekilde yapılandırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="8ca96-207">İşlem hattı ve eklenti derlemesinin, [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]ardışık düzen derlemelerini algılamak [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] için konak [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projesinin kök klasöründe olması gerekir, ancak ' de bu en kolay şekilde yapılır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>

<span data-ttu-id="8ca96-208">Sonuç olarak, ilk adım, her bir ardışık düzen derlemesinin ve eklenti derleme projelerinin yapı çıkışını [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] ayarlayarak projenin köküne ardışık düzen ve eklenti derlemesini oluşturmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="8ca96-209">Aşağıdaki tabloda, konak [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projesi ile aynı çözümde ve kök klasörde bulunan işlem hattı derleme projeleri ve eklenti derleme projesi için yapı çıkış yolları gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>

<span data-ttu-id="8ca96-210">Tablo 1: Bir XBAP tarafından barındırılan işlem hattı derlemeleri için derleme çıkış yolları</span><span class="sxs-lookup"><span data-stu-id="8ca96-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>

|<span data-ttu-id="8ca96-211">Ardışık düzen derleme projesi</span><span class="sxs-lookup"><span data-stu-id="8ca96-211">Pipeline assembly project</span></span>|<span data-ttu-id="8ca96-212">Derleme çıkış yolu</span><span class="sxs-lookup"><span data-stu-id="8ca96-212">Build output path</span></span>|
|-------------------------------|-----------------------|
|<span data-ttu-id="8ca96-213">Sözleşme</span><span class="sxs-lookup"><span data-stu-id="8ca96-213">Contract</span></span>|`..\HostXBAP\Contracts\`|
|<span data-ttu-id="8ca96-214">Eklenti görünümü</span><span class="sxs-lookup"><span data-stu-id="8ca96-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|
|<span data-ttu-id="8ca96-215">Eklenti tarafı bağdaştırıcı</span><span class="sxs-lookup"><span data-stu-id="8ca96-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|
|<span data-ttu-id="8ca96-216">Konak tarafı bağdaştırıcısı</span><span class="sxs-lookup"><span data-stu-id="8ca96-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|
|<span data-ttu-id="8ca96-217">Eklenti</span><span class="sxs-lookup"><span data-stu-id="8ca96-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|

<span data-ttu-id="8ca96-218">Sonraki adım, aşağıdaki işlemleri gerçekleştirerek işlem hattı derlemelerini ve eklenti derlemesini [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] içerik [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] dosyaları olarak belirtmektir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>

1. <span data-ttu-id="8ca96-219">Çözüm Gezgini içindeki her bir işlem hattı klasörüne sağ tıklayıp projeye Ekle ' yi seçerek, işlem hattını ve eklenti derlemesini projeye dahil **edin**.</span><span class="sxs-lookup"><span data-stu-id="8ca96-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>

2. <span data-ttu-id="8ca96-220">Her bir işlem hattı derlemesinin **derleme eylemini** ve **Özellikler** penceresinden **içeriğe** eklenti derlemesini ayarlama.</span><span class="sxs-lookup"><span data-stu-id="8ca96-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>

<span data-ttu-id="8ca96-221">Son adım, uygulama bildirimini indirme için işlem hattı derleme dosyalarını ve eklenti derleme dosyasını içerecek şekilde yapılandırmaktır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="8ca96-222">Dosyalar, [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] uygulamanın kapladığı ClickOnce önbelleğindeki klasörün kökündeki klasörlerde bulunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-222">The files should be located in folders at the root of the folder in the ClickOnce cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="8ca96-223">Yapılandırma, aşağıdaki işlemleri yaparak ' [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] de elde edilebilir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>

1. <span data-ttu-id="8ca96-224">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Projeye sağ tıklayın, **Özellikler**' e tıklayın, **Yayımla**' ya tıklayın ve ardından **uygulama dosyaları** düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="8ca96-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>

2. <span data-ttu-id="8ca96-225">**Uygulama dosyaları** iletişim kutusunda her bir ardışık düzen ve eklenti dll 'Inin **Yayımla durumunu** **(otomatik) içerecek**şekilde ayarlayın ve her BIR işlem hattı ve eklenti dll 'si için **indirme grubunu** **(gerekli)** ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8ca96-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>

### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="8ca96-226">Uygulama temelinden işlem hattını ve eklentiyi kullanma</span><span class="sxs-lookup"><span data-stu-id="8ca96-226">Using the Pipeline and Add-In from the Application Base</span></span>

<span data-ttu-id="8ca96-227">İşlem hattı ve eklenti ClickOnce dağıtımı için yapılandırıldığında, ile aynı ClickOnce önbellek klasörüne [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]indirilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-227">When the pipeline and add-in are configured for ClickOnce deployment, they are downloaded to the same ClickOnce cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="8ca96-228">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]'Danişlem hattını ve eklentiyi kullanmak için, kodbunları[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] uygulama tabanından almalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="8ca96-229">İşlem hatları ve eklentileri kullanmak için .NET Framework eklentisi modelinin çeşitli türleri ve üyeleri, bu senaryo için özel destek sağlar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-229">The various types and members of the .NET Framework add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="8ca96-230">İlk olarak, yol <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> numaralandırma değeri tarafından tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="8ca96-231">Bu değeri, aşağıdakileri içeren işlem hatlarını kullanmak için ilgili eklenti üyelerinin aşırı yüklemeleri ile birlikte kullanırsınız:</span><span class="sxs-lookup"><span data-stu-id="8ca96-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>

- <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="8ca96-232">Konağın kaynak sitesine erişme</span><span class="sxs-lookup"><span data-stu-id="8ca96-232">Accessing the Host's Site of Origin</span></span>

<span data-ttu-id="8ca96-233">Bir eklentinin kaynak sitesinden dosyalara başvurmasına olanak sağlamak için, eklenti konak uygulamasına denk gelen güvenlik yalıtımıyla birlikte yüklenmelidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="8ca96-234">Bu güvenlik düzeyi, <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> numaralandırma değeri tarafından tanımlanır ve bir eklenti etkinleştirildiğinde <xref:System.AddIn.Hosting.AddInToken.Activate%2A> yöntemine geçirilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>

<a name="WPFAddInModelArchitecture"></a>

## <a name="wpf-add-in-architecture"></a><span data-ttu-id="8ca96-235">WPF eklentisi mimarisi</span><span class="sxs-lookup"><span data-stu-id="8ca96-235">WPF Add-In Architecture</span></span>

<span data-ttu-id="8ca96-236">En yüksek düzeyde, bu şekilde, WPF <xref:System.Windows.FrameworkElement>, ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>kullanarak <xref:System.AddIn.Contract.INativeHandleContract>kullanıcı arabirimlerini (doğrudan veya dolaylı olarak <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> türetilmiş) uygulamak için .NET Framework eklentilerin kullanılmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-236">At the highest level, as we've seen, WPF enables .NET Framework add-ins to implement user interfaces (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="8ca96-237">Sonuç olarak ana bilgisayar uygulamasının konak uygulamasındaki kullanıcı arabiriminden görüntülenen <xref:System.Windows.FrameworkElement> bir sonucu döndürülür.</span><span class="sxs-lookup"><span data-stu-id="8ca96-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from UI in the host application.</span></span>

<span data-ttu-id="8ca96-238">Basit UI eklenti senaryolarında bu, geliştirici ihtiyaçlarına göre çok ayrıntıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-238">For simple UI add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="8ca96-239">Özellikle, düzen, kaynak ve veri bağlama gibi ek WPF hizmetlerinden yararlanmaya başlayan daha karmaşık senaryolar için WPF 'nin .NET Framework eklenti modelini nasıl genişlettiği hakkında daha ayrıntılı bilgi için bkz. avantajları anlamak için Kullanıcı arabirimi desteği ve sınırlamaları.</span><span class="sxs-lookup"><span data-stu-id="8ca96-239">For more complex scenarios, particularly those that try to utilize additional WPF services such as layout, resources, and data binding, more detailed knowledge of how WPF extends the .NET Framework add-in model with UI support is required to understand its benefits and limitations.</span></span>

<span data-ttu-id="8ca96-240">Temelde, WPF bir konak uygulamasına bir eklentinin Kullanıcı arabirimini geçirmez; Bunun yerine WPF, WPF birlikte çalışabilirliği kullanarak Kullanıcı arabirimi için Win32 pencere tanıtıcısını geçirir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-240">Fundamentally, WPF doesn't pass a UI from an add-in to a host application; instead, WPF passes the Win32 window handle for the UI by using WPF interoperability.</span></span> <span data-ttu-id="8ca96-241">Bu nedenle, bir eklentinin bir konak uygulamasına bir kullanıcı arabirimi geçirildiğinde aşağıdakiler gerçekleşir:</span><span class="sxs-lookup"><span data-stu-id="8ca96-241">As such, when a UI from an add-in is passed to a host application, the following occurs:</span></span>

- <span data-ttu-id="8ca96-242">Eklenti tarafında, WPF konak uygulama tarafından görüntülenecek kullanıcı arabirimi için bir pencere tutamacı alır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-242">On the add-in side, WPF acquires a window handle for the UI that will be displayed by the host application.</span></span> <span data-ttu-id="8ca96-243">Pencere tutamacı, <xref:System.Windows.Interop.HwndSource> <xref:System.AddIn.Contract.INativeHandleContract>ve ' den türetilen bir iç WPF sınıfı tarafından kapsüllenir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-243">The window handle is encapsulated by an internal WPF class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="8ca96-244">Bu sınıfın bir örneği tarafından <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> döndürülür ve eklentinin uygulama etki alanından ana bilgisayar uygulamasının uygulama etki alanına sıralanır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>

- <span data-ttu-id="8ca96-245">Konak uygulama tarafında WPF, ' den <xref:System.Windows.Interop.HwndSource> <xref:System.Windows.Interop.HwndHost> türetilen ve tüketen <xref:System.AddIn.Contract.INativeHandleContract>dahili bir WPF sınıfı olarak yeniden paketler.</span><span class="sxs-lookup"><span data-stu-id="8ca96-245">On the host application side, WPF repackages the <xref:System.Windows.Interop.HwndSource> as an internal WPF class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="8ca96-246">Bu sınıfın bir örneği tarafından <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> ana bilgisayar uygulamasına döndürülür.</span><span class="sxs-lookup"><span data-stu-id="8ca96-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>

<span data-ttu-id="8ca96-247"><xref:System.Windows.Interop.HwndHost>WPF kullanıcı arabirimlerinden, pencere tutamaçları tarafından tanımlanan kullanıcı arabirimlerini göstermek için mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-247"><xref:System.Windows.Interop.HwndHost> exists to display user interfaces, identified by window handles, from WPF user interfaces.</span></span> <span data-ttu-id="8ca96-248">Daha fazla bilgi için bkz. [WPF ve Win32 birlikte](../advanced/wpf-and-win32-interoperation.md)çalışma.</span><span class="sxs-lookup"><span data-stu-id="8ca96-248">For more information, see [WPF and Win32 Interoperation](../advanced/wpf-and-win32-interoperation.md).</span></span>

<span data-ttu-id="8ca96-249"><xref:System.AddIn.Contract.INativeHandleContract>Özet, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> ' de bir WPF Kullanıcı arabirimi için pencere tutamacının bir eklentinin bir konak uygulamasına geçirilmesine izin vermek, burada bir <xref:System.Windows.Interop.HwndHost> , ve ana bilgisayar uygulamasının Kullanıcı arabirimini görüntülendiği yerdir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a WPF UI to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's UI.</span></span>

> [!NOTE]
> <span data-ttu-id="8ca96-250">Konak uygulama bir <xref:System.Windows.Interop.HwndHost>aldığından, konak uygulama tarafından <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> döndürülen nesneyi eklenti tarafından (örneğin, a <xref:System.Windows.Controls.UserControl>) olarak uygulandığı türüne dönüştüremiyor.</span><span class="sxs-lookup"><span data-stu-id="8ca96-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>

<span data-ttu-id="8ca96-251">Doğası gereği, <xref:System.Windows.Interop.HwndHost> konak uygulamalarının bunları nasıl kullanabileceğinizi etkileyen belirli sınırlamalara sahiptir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="8ca96-252">Ancak WPF, eklenti <xref:System.Windows.Interop.HwndHost> senaryoları için çeşitli yetenekler ile genişletilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-252">However, WPF extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="8ca96-253">Bu avantajlar ve sınırlamalar aşağıda açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-253">These benefits and limitations are described below.</span></span>

<a name="WPFAddInModelBenefits"></a>

## <a name="wpf-add-in-benefits"></a><span data-ttu-id="8ca96-254">WPF eklentisi avantajları</span><span class="sxs-lookup"><span data-stu-id="8ca96-254">WPF Add-In Benefits</span></span>

<span data-ttu-id="8ca96-255">WPF eklentisi kullanıcı arabirimleri, ' den <xref:System.Windows.Interop.HwndHost>türetilen bir iç sınıf kullanılarak konak uygulamalardan görüntülendiğinden, bu kullanıcı arabirimleri, düzen gibi WPF Kullanıcı arabirimi hizmetleriyle ilgili <xref:System.Windows.Interop.HwndHost> yetenekler ile kısıtlanır işleme, veri bağlama, stiller, şablonlar ve kaynaklar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-255">Because WPF add-in user interfaces are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those user interfaces are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to WPF UI services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="8ca96-256">Ancak WPF, iç <xref:System.Windows.Interop.HwndHost> alt sınıfını aşağıdakileri içeren ek yetenekler ile genişlettiğini:</span><span class="sxs-lookup"><span data-stu-id="8ca96-256">However, WPF augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>

- <span data-ttu-id="8ca96-257">Ana bilgisayar uygulamasının Kullanıcı arabirimi ve bir eklentinin Kullanıcı arabirimi arasında sekme.</span><span class="sxs-lookup"><span data-stu-id="8ca96-257">Tabbing between a host application's UI and an add-in's UI.</span></span> <span data-ttu-id="8ca96-258">"Eklenti bir kullanıcı arabirimi" programlama modelinin, eklentinin tam olarak güvenilir veya kısmen güvenilir olup olmadığına bakılmaksızın, sekmeye izin vermek <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> için eklenti tarafı bağdaştırıcısının geçersiz kılınmasını gerektirdiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="8ca96-258">Note that the "add-in is a UI" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>

- <span data-ttu-id="8ca96-259">Ana bilgisayar uygulaması kullanıcı arabirimlerinden görüntülenen eklenti Kullanıcı arabirimleri için erişilebilirlik gereksinimlerini manlama.</span><span class="sxs-lookup"><span data-stu-id="8ca96-259">Honoring accessibility requirements for add-in user interfaces that are displayed from host application user interfaces.</span></span>

- <span data-ttu-id="8ca96-260">WPF uygulamalarının birden çok uygulama etki alanı senaryosunda güvenle çalışmasını sağlama.</span><span class="sxs-lookup"><span data-stu-id="8ca96-260">Enabling WPF applications to run safely in multiple application domain scenarios.</span></span>

- <span data-ttu-id="8ca96-261">Eklentiler güvenlik yalıtımı (yani, kısmi güven güvenlik korumalı alanı) ile çalıştırıldığında eklenti UI penceresine geçersiz erişimi engellemek.</span><span class="sxs-lookup"><span data-stu-id="8ca96-261">Preventing illegal access to add-in UI window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="8ca96-262">Çağırma <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> bu güvenliği sağlar:</span><span class="sxs-lookup"><span data-stu-id="8ca96-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>

  - <span data-ttu-id="8ca96-263">"Eklenti bir kullanıcı arabirimi döndürüyor" programlama modeli için, yalıtım sınırının içindeki bir eklenti Kullanıcı arabirimine yönelik pencere tanıtıcısını geçirmenin tek yolu çağrıladır <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="8ca96-263">For the "add-in returns a UI" programming model, the only way to pass the window handle for an add-in UI across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>

  - <span data-ttu-id="8ca96-264">"Eklenti bir kullanıcı arabirimi" programlama modeli için, eklenti tarafı bağdaştırıcısını ve <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> çağrılmasını <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (önceki örneklerde gösterildiği gibi) geçersiz kılmak, bu durumda eklenti tarafı bağdaştırıcısının `QueryContract` uygulamasını konak tarafı bağdaştırıcısı.</span><span class="sxs-lookup"><span data-stu-id="8ca96-264">For the "add-in is a UI" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>

- <span data-ttu-id="8ca96-265">Birden çok uygulama etki alanı yürütme koruması sağlama.</span><span class="sxs-lookup"><span data-stu-id="8ca96-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="8ca96-266">Uygulama etki alanlarıyla ilgili sınırlamalar nedeniyle, eklenti uygulama etki alanlarında oluşturulan işlenmemiş özel durumlar, yalıtım sınırı var olsa bile tüm uygulamanın kilitlenmesine neden olur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="8ca96-267">Ancak WPF ve .NET Framework eklenti modeli, bu sorunu geçici olarak çözmek için basit bir yol sağlar ve uygulama kararlılığını geliştirir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-267">However, WPF and the .NET Framework add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="8ca96-268">Bir kullanıcı arabirimini görüntüleyen bir WPF eklentisi, uygulama etki alanının <xref:System.Windows.Threading.Dispatcher> üzerinde çalıştığı iş parçacığı için, konak uygulama bir WPF uygulaması ise bir oluşturur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-268">A WPF add-in that displays a UI creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a WPF application.</span></span> <span data-ttu-id="8ca96-269">WPF eklentisinin <xref:System.Windows.Threading.Dispatcher.UnhandledException> <xref:System.Windows.Threading.Dispatcher>olayını işleyerek uygulama etki alanında gerçekleşen tüm işlenmeyen özel durumları tespit edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the WPF add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="8ca96-270">Özelliğinden ' i edinebilirsiniz <xref:System.Windows.Threading.Dispatcher>. <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A></span><span class="sxs-lookup"><span data-stu-id="8ca96-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>

<a name="WPFAddInModelLimitations"></a>

## <a name="wpf-add-in-limitations"></a><span data-ttu-id="8ca96-271">WPF eklentisi sınırlamaları</span><span class="sxs-lookup"><span data-stu-id="8ca96-271">WPF Add-In Limitations</span></span>

<span data-ttu-id="8ca96-272">WPF 'in, <xref:System.Windows.Interop.HwndSource> <xref:System.Windows.Interop.HwndHost>, ve pencere tutamaçları tarafından sağlanan varsayılan davranışlara eklediği avantajların ötesinde, konak uygulamalardan görüntülenen eklenti Kullanıcı arabirimleri için de sınırlamalar vardır:</span><span class="sxs-lookup"><span data-stu-id="8ca96-272">Beyond the benefits that WPF adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in user interfaces that are displayed from host applications:</span></span>

- <span data-ttu-id="8ca96-273">Bir konak uygulamasından görüntülenmiş eklenti Kullanıcı arabirimleri, ana bilgisayar uygulamasının kırpma davranışına uymaz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-273">Add-in user interfaces displayed from a host application do not respect the host application's clipping behavior.</span></span>

- <span data-ttu-id="8ca96-274">Birlikte çalışabilirlik senaryolarında *hava sahası* kavramı, eklentiler için de geçerlidir (bkz. [teknoloji bölgelerine genel bakış](../advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="8ca96-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../advanced/technology-regions-overview.md)).</span></span>

- <span data-ttu-id="8ca96-275">Ana bilgisayar uygulamasının kaynak devralma, veri bağlama ve verme gibi kullanıcı ARABIRIMI Hizmetleri, eklenti Kullanıcı arabirimleri için otomatik olarak kullanılamaz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-275">A host application's UI services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in user interfaces.</span></span> <span data-ttu-id="8ca96-276">Bu hizmetleri eklentiye sağlamak için işlem hattını güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-276">To provide these services to the add-in, you need to update the pipeline.</span></span>

- <span data-ttu-id="8ca96-277">Bir eklenti Kullanıcı arabirimi, dönüşümden döndürülemez, ölçeklendirilemez, çarpıtılmış veya başka bir şekilde etkilenilemez (bkz. [dönüşümler genel bakış](../graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="8ca96-277">An add-in UI cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../graphics-multimedia/transforms-overview.md)).</span></span>

- <span data-ttu-id="8ca96-278"><xref:System.Drawing> Ad alanından çizim işlemleri tarafından oluşturulan eklenti kullanıcı arabirimlerinin içindeki içerikler, Alfa karışımı içerebilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-278">Content inside add-in user interfaces that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="8ca96-279">Ancak, hem eklenti Kullanıcı arabirimi hem de içeren konak uygulama kullanıcı arabirimi% 100 opak olmalıdır; diğer bir deyişle, `Opacity` her ikisinin de özelliğinin 1 olarak ayarlanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-279">However, both an add-in UI and the host application UI that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>

- <span data-ttu-id="8ca96-280">Bir eklenti Kullanıcı arabirimi içeren konak uygulamasındaki bir pencerenin `true` özelliğiolarakayarlandıysa,eklentigörünmezolur.<xref:System.Windows.Window.AllowsTransparency%2A></span><span class="sxs-lookup"><span data-stu-id="8ca96-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in UI is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="8ca96-281">Bu, eklenti Kullanıcı arabirimi% 100 donuk (yani, `Opacity` özelliğin değeri 1) olsa da geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-281">This is true even if the add-in UI is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>

- <span data-ttu-id="8ca96-282">Bir eklenti Kullanıcı arabirimi, aynı üst düzey penceredeki diğer WPF öğelerinin üstünde yer almalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-282">An add-in UI must appear on top of other WPF elements in the same top-level window.</span></span>

- <span data-ttu-id="8ca96-283">Eklentiyi kullanarak bir <xref:System.Windows.Media.VisualBrush>eklentinin Kullanıcı arabiriminin hiçbir bölümünün işlenemeyeceğini.</span><span class="sxs-lookup"><span data-stu-id="8ca96-283">No portion of an add-in's UI can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="8ca96-284">Bunun yerine, eklenti, anlaşma tarafından tanımlanan yöntemler kullanılarak konak uygulamasına geçirilebilecek bir bit eşlem oluşturmak için oluşturulan kullanıcı arabiriminin anlık görüntüsünü alabilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-284">Instead, the add-in may take a snapshot of the generated UI to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>

- <span data-ttu-id="8ca96-285">Medya dosyaları bir <xref:System.Windows.Controls.MediaElement> eklenti Kullanıcı arabirimindeki içinden yürütülemez.</span><span class="sxs-lookup"><span data-stu-id="8ca96-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in UI.</span></span>

- <span data-ttu-id="8ca96-286">Eklenti kullanıcı arabirimi için oluşturulan fare olayları, ana bilgisayar uygulaması tarafından alınmaz veya oluşturulmaz ve `IsMouseOver` konak uygulama kullanıcı arabirimine yönelik özelliğin bir `false`değeri vardır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-286">Mouse events generated for the add-in UI are neither received nor raised by the host application, and the `IsMouseOver` property for host application UI has a value of `false`.</span></span>

- <span data-ttu-id="8ca96-287">Odak, eklenti Kullanıcı arabirimindeki `GotFocus` denetimler arasında kayıldığında, ve `LostFocus` olayları konak uygulama tarafından alınmaz veya oluşturulmaz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-287">When focus shifts between controls in an add-in UI, the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>

- <span data-ttu-id="8ca96-288">Eklenti kullanıcı arabirimi içeren bir ana bilgisayar uygulamasının bölümü yazdırıldığında beyaz görünür.</span><span class="sxs-lookup"><span data-stu-id="8ca96-288">The portion of a host application that contains an add-in UI appears white when printed.</span></span>

- <span data-ttu-id="8ca96-289">Konak uygulama yürütmeye devam ederse <xref:System.Windows.Threading.Dispatcher>, eklenti Kullanıcı arabirimi tarafından oluşturulan tüm sevkiyatcıların (bkz.), sahip eklentisi kaldırılmadan önce el ile kapatılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ca96-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in UI must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="8ca96-290">Sözleşme, Eklenti kaldırılmadan önce ana bilgisayar uygulamasının eklentiye sinyal vermesini sağlayan yöntemler uygulayabilir ve bu sayede eklenti Kullanıcı arabiriminin dispatchlarını kapatmasına izin vermiş olur.</span><span class="sxs-lookup"><span data-stu-id="8ca96-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in UI to shut down its dispatchers.</span></span>

- <span data-ttu-id="8ca96-291">Bir eklenti Kullanıcı arabirimi bir <xref:System.Windows.Controls.InkCanvas> veya <xref:System.Windows.Controls.InkCanvas>içeriyorsa, eklentiyi kaldıramazsınız.</span><span class="sxs-lookup"><span data-stu-id="8ca96-291">If an add-in UI is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>

<a name="PerformanceOptimization"></a>

## <a name="performance-optimization"></a><span data-ttu-id="8ca96-292">Performans Iyileştirmesi</span><span class="sxs-lookup"><span data-stu-id="8ca96-292">Performance Optimization</span></span>

<span data-ttu-id="8ca96-293">Varsayılan olarak, birden çok uygulama etki alanı kullanıldığında, her bir uygulama için gereken çeşitli .NET Framework derlemeleri bu uygulamanın etki alanına yüklenir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-293">By default, when multiple application domains are used, the various .NET Framework assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="8ca96-294">Sonuç olarak, yeni uygulama etki alanları oluşturmak için gereken süre ve içindeki uygulamaları başlatmak performansı etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="8ca96-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="8ca96-295">Ancak .NET Framework, uygulamaların zaten yüklü olmaları durumunda derlemeleri uygulama etki alanları arasında paylaşmasını sağlayarak başlangıç zamanlarını düşürmeniz için bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="8ca96-295">However, the .NET Framework provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="8ca96-296">Bunu, giriş noktası yöntemine ( <xref:System.LoaderOptimizationAttribute> `Main`) uygulanması gereken özniteliğini kullanarak yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="8ca96-297">Bu durumda, uygulama tanımınızı uygulamak için yalnızca kod kullanmanız gerekir (bkz. [uygulama yönetimine genel bakış](application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="8ca96-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](application-management-overview.md)).</span></span>

## <a name="see-also"></a><span data-ttu-id="8ca96-298">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="8ca96-298">See also</span></span>

- <xref:System.LoaderOptimizationAttribute>
- <span data-ttu-id="8ca96-299">[Eklentiler ve Genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span><span class="sxs-lookup"><span data-stu-id="8ca96-299">[Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span></span>
- [<span data-ttu-id="8ca96-300">Uygulama Etki Alanları</span><span class="sxs-lookup"><span data-stu-id="8ca96-300">Application Domains</span></span>](../../app-domains/application-domains.md)
- <span data-ttu-id="8ca96-301">[.NET Framework uzaktan Iletişim genel bakış](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="8ca96-301">[.NET Framework Remoting Overview](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))</span></span>
- <span data-ttu-id="8ca96-302">[Nesneleri Uzaktan erişilebilir hale getirme](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="8ca96-302">[Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))</span></span>
- [<span data-ttu-id="8ca96-303">Nasıl Yapılır Konuları</span><span class="sxs-lookup"><span data-stu-id="8ca96-303">How-to Topics</span></span>](how-to-topics.md)
