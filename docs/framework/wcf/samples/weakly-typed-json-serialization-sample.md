---
title: Zayıf yazılmış JSON Seri Hale Getirme Örneği
ms.date: 03/30/2017
ms.assetid: 0b30e501-4ef5-474d-9fad-a9d559cf9c52
ms.openlocfilehash: 1450a0e46ade615769d7ffdc1006102772dbc977
ms.sourcegitcommit: 14ad34f7c4564ee0f009acb8bfc0ea7af3bc9541
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/01/2019
ms.locfileid: "73424536"
---
# <a name="weakly-typed-json-serialization-sample"></a><span data-ttu-id="c0c0b-102">Zayıf yazılmış JSON Seri Hale Getirme Örneği</span><span class="sxs-lookup"><span data-stu-id="c0c0b-102">Weakly-typed JSON Serialization Sample</span></span>
<span data-ttu-id="c0c0b-103">Kullanıcı tanımlı bir türü belirli bir hat biçiminde serileştirilirken veya bir tel biçiminin Kullanıcı tanımlı bir türe geri serisi kaldırılırken, belirtilen kullanıcı tanımlı tür hem hizmette hem de istemcide kullanılabilir olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-103">When serializing a user-defined type to a given wire format, or deserializing a wire format back into a user-defined type, the given user-defined type must be available on both the service and the client.</span></span> <span data-ttu-id="c0c0b-104">Genellikle bunu gerçekleştirmek için, <xref:System.Runtime.Serialization.DataContractAttribute> özniteliği bu kullanıcı tanımlı türlere uygulanır ve <xref:System.Runtime.Serialization.DataMemberAttribute> özniteliği üyelerine uygulanır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-104">Usually to accomplish this, the <xref:System.Runtime.Serialization.DataContractAttribute> attribute is applied to these user-defined types and the <xref:System.Runtime.Serialization.DataMemberAttribute> attribute is applied to their members.</span></span> <span data-ttu-id="c0c0b-105">Bu mekanizma Ayrıca JavaScript Nesne Gösterimi (JSON) nesneleriyle çalışırken, [JSON verilerini serileştirme ve serisini kaldırma](../../../../docs/framework/wcf/feature-details/how-to-serialize-and-deserialize-json-data.md)konusunda açıklandığı şekilde geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-105">This mechanism also applies when working with JavaScript Object Notation (JSON) objects, as described in the topic [How to: Serialize and Deserialize JSON Data](../../../../docs/framework/wcf/feature-details/how-to-serialize-and-deserialize-json-data.md).</span></span>  
  
 <span data-ttu-id="c0c0b-106">Bazı senaryolarda, bir Windows Communication Foundation (WCF) hizmeti veya istemcisinin, geliştirici denetimi dışında bir hizmet veya istemci tarafından oluşturulan JSON nesnelerine erişmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-106">In some scenarios, a Windows Communication Foundation (WCF) service or client must access JSON objects generated by a service or client that is outside of the control of the developer.</span></span> <span data-ttu-id="c0c0b-107">Daha fazla Web hizmeti JSON API 'Leri kullanıma sunduğundan, WCF geliştiricisinin rastgele JSON nesnelerinin serisini kaldırmak için yerel kullanıcı tanımlı türler oluşturmasına pratik hale gelebilir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-107">As more Web services publicly expose JSON APIs, it can become impractical for the WCF developer to construct local user-defined types into which to deserialize arbitrary JSON objects.</span></span> <span data-ttu-id="c0c0b-108">Bu örnek, WCF geliştiricilerinin Kullanıcı tanımlı türler oluşturmadan, serisi olmayan, rastgele JSON nesneleriyle çalışmasını sağlayan bir mekanizma sağlar.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-108">This sample provides a mechanism that enables WCF developers to work with deserialized, arbitrary JSON objects, without creating user-defined types.</span></span> <span data-ttu-id="c0c0b-109">JSON nesnelerinin, derleme zamanında bilinmediği tür olmadığı için, bu, JSON nesnelerinin *zayıf olarak yazılmış seri hale getirme* olarak bilinir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-109">This is known as *weakly-typed serialization* of JSON objects, because the type into which a JSON object deserializes is not known at compile time.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="c0c0b-110">Bu örneğe ilişkin Kurulum yordamı ve derleme yönergeleri bu konunun sonunda bulunur.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-110">The setup procedure and build instructions for this sample are located at the end of this topic.</span></span>  
  
 <span data-ttu-id="c0c0b-111">Örneğin, bir genel Web hizmeti API 'SI, bir hizmetin kullanıcısı hakkında bazı bilgileri açıklayan aşağıdaki JSON nesnesini döndürür.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-111">For example, a public Web service API returns the following JSON object, which describes some information about a user of the service.</span></span>  
  
```json  
{"personal": {"name": "Paul", "age": 23, "height": 1.7, "isSingle": true, "luckyNumbers": [5,17,21]}, "favoriteBands": ["Band ABC", "Band XYZ"]}  
```  
  
 <span data-ttu-id="c0c0b-112">Bu nesnenin serisini kaldırmak için, bir WCF istemcisinin aşağıdaki Kullanıcı tanımlı türleri uygulaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-112">To deserialize this object, a WCF client must implement the following user-defined types.</span></span>  
  
```csharp  
[DataContract]  
 public class MemberProfile  
 {  
     [DataMember]  
     public PersonalInfo personal;  
  
     [DataMember]  
     public string[] favoriteBands;  
 }  
  
 [DataContract]  
 public class PersonalInfo  
 {  
     [DataMember]  
     public string name;  
  
     [DataMember]  
     public int age;  
  
     [DataMember]  
     public double height;  
  
     [DataMember]  
     public bool isSingle;  
  
     [DataMember]  
     public int[] luckyNumbers;  
 }  
```  
  
 <span data-ttu-id="c0c0b-113">Özellikle istemcinin birden fazla JSON nesne türünü işlemesi gerekiyorsa, bu çok sayıda olabilir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-113">This can be cumbersome, especially if the client has to handle more than one type of JSON object.</span></span>  
  
 <span data-ttu-id="c0c0b-114">Bu örnek tarafından belirtilen `JsonObject` türü, serisi kaldırılan JSON nesnesinin zayıf yazılmış bir gösterimini tanıtır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-114">The `JsonObject` type provided by this sample introduces a weakly-typed representation of the deserialized JSON object.</span></span> <span data-ttu-id="c0c0b-115">`JsonObject`, JSON nesneleri ile .NET Framework sözlükleri arasındaki doğal eşlemeyi ve JSON dizileri ile .NET Framework dizileri arasındaki eşlemeyi kullanır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-115">`JsonObject` relies on the natural mapping between JSON objects and .NET Framework dictionaries, and the mapping between JSON arrays and .NET Framework arrays.</span></span> <span data-ttu-id="c0c0b-116">Aşağıdaki kod `JsonObject` türünü gösterir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-116">The following code shows the `JsonObject` type.</span></span>  
  
```csharp  
// Instantiation of JsonObject json omitted  
  
string name = json["root"]["personal"]["name"];  
int age = json["root"]["personal"]["age"];  
double height = json["root"]["personal"]["height"];  
bool isSingle = json["root"]["personal"]["isSingle"];  
int[] luckyNumbers = {  
                                     json["root"]["personal"]["luckyNumbers"][0],  
                                     json["root"]["personal"]["luckyNumbers"][1],  
                                     json["root"]["personal"]["luckyNumbers"][2]   
                                 };  
string[] favoriteBands = {  
                                        json["root"]["favoriteBands"][0],  
                                        json["root"]["favoriteBands"][1]  
                                    };  
```  
  
 <span data-ttu-id="c0c0b-117">Derleme zamanında türlerini bildirmek zorunda kalmadan, JSON nesnelerine ve dizilerine "göz atabileceğinizi" unutmayın.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-117">Note that you can "browse" JSON objects and arrays without the need to declare their type at compile time.</span></span> <span data-ttu-id="c0c0b-118">Üst düzey `["root"]` nesnesine yönelik gereksinimin açıklaması için, bkz. [JSON ve XML arasındaki konuya eşleme](../../../../docs/framework/wcf/feature-details/mapping-between-json-and-xml.md).</span><span class="sxs-lookup"><span data-stu-id="c0c0b-118">For an explanation of the requirement for the top-level `["root"]` object, see the topic [Mapping Between JSON and XML](../../../../docs/framework/wcf/feature-details/mapping-between-json-and-xml.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="c0c0b-119">`JsonObject` sınıfı yalnızca bir örnek olarak sağlanır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-119">The `JsonObject` class is provided as an example only.</span></span> <span data-ttu-id="c0c0b-120">Kapsamlı olarak test edilmemiştir ve üretim ortamlarında kullanılmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-120">It has not been thoroughly tested, and should not be used in production environments.</span></span> <span data-ttu-id="c0c0b-121">Kesin türü belirtilmiş JSON serileştirmesi, `JsonObject`ile çalışırken tür güvenliği olmamasıdır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-121">An obvious implication of weakly-typed JSON serialization is the lack of type-safety when working with `JsonObject`.</span></span>  
  
 <span data-ttu-id="c0c0b-122">`JsonObject` türünü kullanmak için, istemci işlem sözleşmesinin dönüş türü olarak <xref:System.ServiceModel.Channels.Message> kullanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-122">To use the `JsonObject` type, the client operation contract must use <xref:System.ServiceModel.Channels.Message> as its return type.</span></span>  
  
```csharp  
[ServiceContract]  
    interface IClientSideProfileService  
    {  
        // There is no need to write a DataContract for the complex type returned by the service.  
        // The client will use a JsonObject to browse the JSON in the received message.  
  
        [OperationContract]  
        [WebGet(ResponseFormat = WebMessageFormat.Json)]  
        Message GetMemberProfile();  
    }  
```  
  
 <span data-ttu-id="c0c0b-123">`JsonObject`, aşağıdaki kodda gösterildiği gibi oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-123">The `JsonObject` is then instantiated as shown in the following code.</span></span>  
  
```csharp  
// Code to instantiate IClientSideProfileService channel omitted…  
  
// Make a request to the service and obtain the Json response  
XmlDictionaryReader reader = channel.GetMemberProfile().GetReaderAtBodyContents();  
  
// Go through the Json as though it is a dictionary. There is no need to map it to a .NET CLR type.  
JsonObject json = new JsonObject(reader);  
```  
  
 <span data-ttu-id="c0c0b-124">`JsonObject` Oluşturucusu <xref:System.ServiceModel.Channels.Message.GetReaderAtBodyContents%2A> yöntemi aracılığıyla elde edilen bir <xref:System.Xml.XmlDictionaryReader>alır.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-124">The `JsonObject` constructor takes a <xref:System.Xml.XmlDictionaryReader>, which is obtained through the <xref:System.ServiceModel.Channels.Message.GetReaderAtBodyContents%2A> method.</span></span> <span data-ttu-id="c0c0b-125">Okuyucu, istemci tarafından alınan JSON iletisinin bir XML gösterimini içerir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-125">The reader contains an XML representation of the JSON message received by the client.</span></span> <span data-ttu-id="c0c0b-126">Daha fazla bilgi için bkz. [JSON ve XML arasındaki konuya eşleme](../../../../docs/framework/wcf/feature-details/mapping-between-json-and-xml.md).</span><span class="sxs-lookup"><span data-stu-id="c0c0b-126">For more information, see the topic [Mapping Between JSON and XML](../../../../docs/framework/wcf/feature-details/mapping-between-json-and-xml.md).</span></span>  
  
 <span data-ttu-id="c0c0b-127">Program aşağıdaki çıktıyı üretir:</span><span class="sxs-lookup"><span data-stu-id="c0c0b-127">The program produces the following output:</span></span>  
  
```console  
Service listening at http://localhost:8000/.  
To view the JSON output from the sample, navigate to http://localhost:8000/GetMemberProfile  
This is Paul's page. I am 23 years old and I am 1.7 meters tall.  
I am single.  
My lucky numbers are 5, 17, and 21.  
My favorite bands are Band ABC and Band XYZ.  
```  
  
### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="c0c0b-128">Örneği ayarlamak, derlemek ve çalıştırmak için</span><span class="sxs-lookup"><span data-stu-id="c0c0b-128">To set up, build, and run the sample</span></span>  
  
1. <span data-ttu-id="c0c0b-129">[Windows Communication Foundation Örnekleri Için tek seferlik Kurulum yordamını](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)gerçekleştirdiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-129">Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).</span></span>  
  
2. <span data-ttu-id="c0c0b-130">[Windows Communication Foundation örnekleri oluşturma](../../../../docs/framework/wcf/samples/building-the-samples.md)bölümünde açıklandığı gibi WeaklyTypedJson. sln çözümünü oluşturun.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-130">Build the solution WeaklyTypedJson.sln as described in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).</span></span>  
  
3. <span data-ttu-id="c0c0b-131">Çözümü çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-131">Run the solution.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="c0c0b-132">Örnekler makinenizde zaten yüklü olabilir.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-132">The samples may already be installed on your machine.</span></span> <span data-ttu-id="c0c0b-133">Devam etmeden önce aşağıdaki (varsayılan) dizini denetleyin.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-133">Check for the following (default) directory before continuing.</span></span>  
>   
> `<InstallDrive>:\WF_WCF_Samples`  
>   
> <span data-ttu-id="c0c0b-134">Bu dizin yoksa, tüm Windows Communication Foundation (WCF) ve [!INCLUDE[wf1](../../../../includes/wf1-md.md)] örneklerini indirmek üzere [.NET Framework 4 için Windows Communication Foundation (WCF) ve Windows Workflow Foundation (WF) örneklerine](https://go.microsoft.com/fwlink/?LinkId=150780) gidin.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-134">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="c0c0b-135">Bu örnek, aşağıdaki dizinde bulunur.</span><span class="sxs-lookup"><span data-stu-id="c0c0b-135">This sample is located in the following directory.</span></span>  
>   
> `<InstallDrive>:\WF_WCF_Samples\WCF\Scenario\Ajax\WeaklyTypedJson`  
