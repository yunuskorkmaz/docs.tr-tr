---
title: Mikro hizmetler (tümleştirme olayları) arasında olay tabanlı iletişim uygulama
description: Kapsayıcılı .NET uygulamaları için .NET mikro hizmet mimarisi | Mikro hizmetler arasında olay tabanlı iletişim uygulamak için tümleştirme olayları anlayın.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/02/2018
ms.openlocfilehash: 844d4bd8ac18bc31b5abeff5882df1f9a4acaab5
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/10/2018
ms.locfileid: "53147270"
---
# <a name="implementing-event-based-communication-between-microservices-integration-events"></a><span data-ttu-id="5159d-103">Mikro hizmetler (tümleştirme olayları) arasında olay tabanlı iletişim uygulama</span><span class="sxs-lookup"><span data-stu-id="5159d-103">Implementing event-based communication between microservices (integration events)</span></span>

<span data-ttu-id="5159d-104">Olay tabanlı iletişim kullandığınızda, daha önce açıklandığı gibi bir mikro hizmet önemli bir sorun olduğunda bir iş varlığı güncelleştirdiği gibi durum gerçekleştiğinde bir olay yayımlar.</span><span class="sxs-lookup"><span data-stu-id="5159d-104">As described earlier, when you use event-based communication, a microservice publishes an event when something notable happens, such as when it updates a business entity.</span></span> <span data-ttu-id="5159d-105">Diğer mikro hizmetler, bu olaylara abone olun.</span><span class="sxs-lookup"><span data-stu-id="5159d-105">Other microservices subscribe to those events.</span></span> <span data-ttu-id="5159d-106">Bir mikro hizmet, bir olayı aldığında, yayımlanmakta daha fazla olay için yol açabilecek kendi iş varlıklarını güncelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5159d-106">When a microservice receives an event, it can update its own business entities, which might lead to more events being published.</span></span> <span data-ttu-id="5159d-107">Son tutarlılık kavram ortaya budur.</span><span class="sxs-lookup"><span data-stu-id="5159d-107">This is the essence of the eventual consistency concept.</span></span> <span data-ttu-id="5159d-108">Bu yayımlama/abone olma sistem, genellikle bir olay veri yolu uygulaması kullanılarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-108">This publish/subscribe system is usually performed by using an implementation of an event bus.</span></span> <span data-ttu-id="5159d-109">Olay veri yoluna abone olma ve aboneliği olayları ve olayları yayımlamak için gereken API ile arabirim olarak tasarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-109">The event bus can be designed as an interface with the API needed to subscribe and unsubscribe to events and to publish events.</span></span> <span data-ttu-id="5159d-110">Bir ileti kuyruğu veya zaman uyumsuz iletişim ve bir yayımlama/abone olma modelini destekleyen bir service bus gibi tüm işlemler arası veya Mesajlaşma iletişimi göre bir veya daha fazla uygulamaları da olabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-110">It can also have one or more implementations based on any inter-process or messaging communication, such as a messaging queue or a service bus that supports asynchronous communication and a publish/subscribe model.</span></span>

<span data-ttu-id="5159d-111">Olayları birden çok hizmet span iş işlemleri uygulamak üzere bu hizmetler arasındaki son tutarlılık sağlayan kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5159d-111">You can use events to implement business transactions that span multiple services, which gives you eventual consistency between those services.</span></span> <span data-ttu-id="5159d-112">Sonunda tutarlı bir işlem, dağıtılmış işlemlerin bir dizi oluşur.</span><span class="sxs-lookup"><span data-stu-id="5159d-112">An eventually consistent transaction consists of a series of distributed actions.</span></span> <span data-ttu-id="5159d-113">Her eylem bir mikro hizmet iş varlığı güncelleştirir ve sonraki eylemi tetikleyen bir olay yayımlar.</span><span class="sxs-lookup"><span data-stu-id="5159d-113">At each action, the microservice updates a business entity and publishes an event that triggers the next action.</span></span>

![Sepet ve ek mikro hizmetler nihai tutarlılığı elde etmek için bir olay veri yolu ile olay temelli iletişimi kullanarak Kataloğu mikro hizmet.](./media/image19.png)

<span data-ttu-id="5159d-115">**Şekil 6-18**.</span><span class="sxs-lookup"><span data-stu-id="5159d-115">**Figure 6-18**.</span></span> <span data-ttu-id="5159d-116">Bir olay veri yoluna bağlı olarak olay tabanlı iletişim</span><span class="sxs-lookup"><span data-stu-id="5159d-116">Event-driven communication based on an event bus</span></span>

<span data-ttu-id="5159d-117">Bu bölümde, Şekil 6-18'de gösterildiği gibi bir genel olay veri yolu arabirimini kullanarak bu tür .NET ile iletişimin nasıl uygulayacağınıza dair açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="5159d-117">This section describes how you can implement this type of communication with .NET by using a generic event bus interface, as shown in Figure 6-18.</span></span> <span data-ttu-id="5159d-118">Her bir farklı teknoloji veya RabbitMQ, Azure Service Bus veya diğer üçüncü taraf açık kaynak veya ticari service bus gibi altyapı kullanarak birden çok olası uygulamaları vardır.</span><span class="sxs-lookup"><span data-stu-id="5159d-118">There are multiple potential implementations, each using a different technology or infrastructure such as RabbitMQ, Azure Service Bus, or any other third-party open-source or commercial service bus.</span></span>

## <a name="using-message-brokers-and-services-buses-for-production-systems"></a><span data-ttu-id="5159d-119">İleti aracıları ve Hizmetleri yollarına üretim sistemleri için kullanma</span><span class="sxs-lookup"><span data-stu-id="5159d-119">Using message brokers and services buses for production systems</span></span>

<span data-ttu-id="5159d-120">Mimari bölümünde belirtildiği gibi soyut olay veri yolu uygulamak için birden çok Mesajlaşma teknolojilerinin arasından seçim yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5159d-120">As noted in the architecture section, you can choose from multiple messaging technologies for implementing your abstract event bus.</span></span> <span data-ttu-id="5159d-121">Ancak, farklı düzeylerde bu teknolojilerdir.</span><span class="sxs-lookup"><span data-stu-id="5159d-121">But these technologies are at different levels.</span></span> <span data-ttu-id="5159d-122">Örneğin, RabbitMQ, Mesajlaşma Aracısı Aktarım, Azure Service Bus, NServiceBus, MassTransit veya Brighter gibi ticari ürünleri daha düşük bir düzeyde altındadır.</span><span class="sxs-lookup"><span data-stu-id="5159d-122">For instance, RabbitMQ, a messaging broker transport, is at a lower level than commercial products like Azure Service Bus, NServiceBus, MassTransit, or Brighter.</span></span> <span data-ttu-id="5159d-123">Bu ürünlerin çoğunu, RabbitMQ veya Azure Service Bus üzerinde çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-123">Most of these products can work on top of either RabbitMQ or Azure Service Bus.</span></span> <span data-ttu-id="5159d-124">Ürün tercih ettiğiniz kaç özellikleri ve ne kadar out-bulunmayan ölçeklenebilirlik, uygulamanız için gereken bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="5159d-124">Your choice of product depends on how many features and how much out-of-the-box scalability you need for your application.</span></span>

<span data-ttu-id="5159d-125">Yalnızca bir olay veri yolu kavram kanıtı hizmetine örnek olduğu gibi geliştirme ortamınız için uygulamak için basit bir uygulama bir kapsayıcı olarak çalışan RabbitMQ üzerinde yeterli olabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-125">For implementing just an event bus proof-of-concept for your development environment, as in the eShopOnContainers sample, a simple implementation on top of RabbitMQ running as a container might be enough.</span></span> <span data-ttu-id="5159d-126">Ancak için Görev açısından kritik ve yüksek ölçeklenebilirlik gerektiren üretim sistemlerine değerlendirmek ve Azure hizmet veri Yolu'nu olmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5159d-126">But for mission-critical and production systems that need high scalability, you might want to evaluate and use Azure Service Bus.</span></span>

<span data-ttu-id="5159d-127">Yüksek düzeyde soyutlama gerektiriyorsa ve gibi daha zengin özellikler [Sagas](https://docs.particular.net/nservicebus/sagas/) Dağıtılmış Geliştirme yapmak daha kolay, diğer ticari ve açık kaynak hizmeti yollarına NServiceBus, MassTransit, gibi uzun süre çalışan işlemler için ve Parlak değerlendirme değer var.</span><span class="sxs-lookup"><span data-stu-id="5159d-127">If you require high-level abstractions and richer features like [Sagas](https://docs.particular.net/nservicebus/sagas/) for long-running processes that make distributed development easier, other commercial and open-source service buses like NServiceBus, MassTransit, and Brighter are worth evaluating.</span></span> <span data-ttu-id="5159d-128">Bu durumda, soyutlamaları ve kullanmak için API genellikle doğrudan bu üst düzey hizmet yolları yerine kendi soyutlama tarafından sağlanan olanları olur (gibi [sağlanan hizmetine basit olay veri yolu soyutlama](https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs)).</span><span class="sxs-lookup"><span data-stu-id="5159d-128">In this case, the abstractions and API to use would usually be directly the ones provided by those high-level service buses instead of your own abstractions (like the [simple event bus abstractions provided at eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs)).</span></span> <span data-ttu-id="5159d-129">Bu konular için ' ın, araştırma [çatallanmış NServiceBus kullanarak hizmetine](https://go.particular.net/eShopOnContainers) (belirli bir yazılım tarafından uygulanan ek türetilmiş örneği)</span><span class="sxs-lookup"><span data-stu-id="5159d-129">For that matter, you can research the [forked eShopOnContainers using NServiceBus](https://go.particular.net/eShopOnContainers) (additional derived sample implemented by Particular Software)</span></span>

<span data-ttu-id="5159d-130">Elbette, her zaman kendi hizmet veri yolu özelliklerinin RabbitMQ ve Docker gibi alt düzey teknolojileri üzerine da oluşturabilirsiniz, ancak "tekerleği geliştirdi için" gereken çalışmayı özel Kurumsal uygulama için çok yüksek maliyetli olabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-130">Of course, you could always build your own service bus features on top of lower-level technologies like RabbitMQ and Docker, but the work needed to “reinvent the wheel” might be too costly for a custom enterprise application.</span></span>

<span data-ttu-id="5159d-131">Bir kez daha açıklayalım: örnek olay veri yolu soyutlamaları ve uygulama hizmetine örnekte büyütmüş yalnızca kavram kanıtı kullanılmak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="5159d-131">To reiterate: the sample event bus abstractions and implementation showcased in the eShopOnContainers sample are intended to be used only as a proof of concept.</span></span> <span data-ttu-id="5159d-132">Zaman uyumsuz ve olay odaklı iletişim sağlamak geçerli bölümünde açıklandığı gibi istediğiniz verdikten sonra üretim için ihtiyaçlarınıza en uygun hizmet veri yolu ürün seçmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5159d-132">Once you have decided that you want to have asynchronous and event-driven communication, as explained in the current section, you should choose the service bus product that best fits your needs for production.</span></span>

## <a name="integration-events"></a><span data-ttu-id="5159d-133">Tümleştirme olayları</span><span class="sxs-lookup"><span data-stu-id="5159d-133">Integration events</span></span>

<span data-ttu-id="5159d-134">Tümleştirme olayları, birden çok mikro hizmette veya dış sistemler arasında etki alanı durumu eşitlenmiş getirmek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="5159d-134">Integration events are used for bringing domain state in sync across multiple microservices or external systems.</span></span> <span data-ttu-id="5159d-135">Bu, mikro hizmet dışında tümleştirme olayları yayımlama tarafından gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-135">This is done by publishing integration events outside the microservice.</span></span> <span data-ttu-id="5159d-136">Birden çok alıcı mikro hizmetler (için tümleştirme olaya abone olduğu gibi çok mikro hizmetler) için bir olay yayımlandığında her alıcı mikro hizmet uygun olay işleyicisi olayını işler.</span><span class="sxs-lookup"><span data-stu-id="5159d-136">When an event is published to multiple receiver microservices (to as many microservices as are subscribed to the integration event), the appropriate event handler in each receiver microservice handles the event.</span></span>

<span data-ttu-id="5159d-137">Bir tümleştirme temel olarak aşağıdaki örnekte olduğu gibi bir veri tutan sınıf olaydır:</span><span class="sxs-lookup"><span data-stu-id="5159d-137">An integration event is basically a data-holding class, as in the following example:</span></span>

```csharp
public class ProductPriceChangedIntegrationEvent : IntegrationEvent
{
    public int ProductId { get; private set; }
    public decimal NewPrice { get; private set; }
    public decimal OldPrice { get; private set; }

    public ProductPriceChangedIntegrationEvent(int productId, decimal newPrice,
        decimal oldPrice)
    {
        ProductId = productId;
        NewPrice = newPrice;
        OldPrice = oldPrice;
    }
}
```

<span data-ttu-id="5159d-138">Gelen bir şekilde nasıl Viewmodel'lar sunucu ve istemci tanımlandığı için karşılaştırılabilir diğer mikro hizmetler, ayrılmış şekilde her mikro hizmet uygulama düzeyinde tümleştirme olayları tanımlanabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-138">The integration events can be defined at the application level of each microservice, so they are decoupled from other microservices, in a way comparable to how ViewModels are defined in the server and client.</span></span> <span data-ttu-id="5159d-139">Ne önerilmez birden fazla mikro hizmetler arasında ortak bir tümleştirme olayları kitaplığı paylaşıyor; Bunu tek olay tanımı veri kitaplığı ile bu mikro hizmetler eşlenmesiyle.</span><span class="sxs-lookup"><span data-stu-id="5159d-139">What is not recommended is sharing a common integration events library across multiple microservices; doing that would be coupling those microservices with a single event definition data library.</span></span> <span data-ttu-id="5159d-140">Aynı ortak bir etki alanı modeli birden çok mikro hizmetler arasında paylaşmak istemediğiniz açısından yapmak istiyor musunuz: mikro hizmetler tamamen otonom olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="5159d-140">You do not want to do that for the same reasons that you do not want to share a common domain model across multiple microservices: microservices must be completely autonomous.</span></span>

<span data-ttu-id="5159d-141">Yalnızca birkaç tür kitaplıkları mikro hizmetler arasında paylaşmalıdır vardır.</span><span class="sxs-lookup"><span data-stu-id="5159d-141">There are only a few kinds of libraries you should share across microservices.</span></span> <span data-ttu-id="5159d-142">Son uygulama bloğu gibi kitaplıkları biridir [olay veri yolu istemci API](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/BuildingBlocks/EventBus), hizmetine gibi.</span><span class="sxs-lookup"><span data-stu-id="5159d-142">One is libraries that are final application blocks, like the [Event Bus client API](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/BuildingBlocks/EventBus), as in eShopOnContainers.</span></span> <span data-ttu-id="5159d-143">JSON seri hale getiricileri genişletme gibi NuGet bileşenlerini de paylaşım araçları oluşturan kitaplıkları da başka bir özelliktir.</span><span class="sxs-lookup"><span data-stu-id="5159d-143">Another is libraries that constitute tools that could also be shared as NuGet components, like JSON serializers.</span></span>

## <a name="the-event-bus"></a><span data-ttu-id="5159d-144">Olay veri yolu</span><span class="sxs-lookup"><span data-stu-id="5159d-144">The event bus</span></span>

<span data-ttu-id="5159d-145">Bir olay veri yolu Şekil 6-19'gösterildiği gibi açıkça birbirinden farkında olması gereken bileşenleri gerektirmeden mikro hizmetler arasında yayımlama/abone olun-style iletişime olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="5159d-145">An event bus allows publish/subscribe-style communication between microservices without requiring the components to explicitly be aware of each other, as shown in Figure 6-19.</span></span>

![Temel pub/sub desenini, mikro hizmet bir olay veri yolu susbcribing mikro B ve C, yayımcı susbcribers bilmenize gerek dağıtan yayımlar.](./media/image20.png)

<span data-ttu-id="5159d-147">**Şekil 6-19**.</span><span class="sxs-lookup"><span data-stu-id="5159d-147">**Figure 6-19**.</span></span> <span data-ttu-id="5159d-148">Yayımlama/abonelik bir olay veri yolu temel kavramları</span><span class="sxs-lookup"><span data-stu-id="5159d-148">Publish/subscribe basics with an event bus</span></span>

<span data-ttu-id="5159d-149">Olay veri yolu gözlemci deseni ve yayımlama ilgili-abone ol modeli.</span><span class="sxs-lookup"><span data-stu-id="5159d-149">The event bus is related to the Observer pattern and the publish-subscribe pattern.</span></span>

### <a name="observer-pattern"></a><span data-ttu-id="5159d-150">Gözlemci deseni</span><span class="sxs-lookup"><span data-stu-id="5159d-150">Observer pattern</span></span>

<span data-ttu-id="5159d-151">İçinde [gözlemci deseni](https://en.wikipedia.org/wiki/Observer_pattern), birincil nesnenizin (Observable bilinir) ilgili bilgileri (olayları) ile (gözlemciler bilinir) diğer ilgili nesneleri bildirir.</span><span class="sxs-lookup"><span data-stu-id="5159d-151">In the [Observer pattern](https://en.wikipedia.org/wiki/Observer_pattern), your primary object (known as the Observable) notifies other interested objects (known as Observers) with relevant information (events).</span></span>

### <a name="publishsubscribe-pubsub-pattern"></a><span data-ttu-id="5159d-152">Yayımlama/abone ol (Pub/Sub) deseni</span><span class="sxs-lookup"><span data-stu-id="5159d-152">Publish/Subscribe (Pub/Sub) pattern</span></span> 

<span data-ttu-id="5159d-153">Amacı [Yayımla/abone ol deseni](https://msdn.microsoft.com/library/ff649664.aspx) gözlemci deseni ile aynıdır: belirli olaylar gerçekleştiğinde diğer hizmetleri bildirimde bulunmak istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="5159d-153">The purpose of the [Publish/Subscribe pattern](https://msdn.microsoft.com/library/ff649664.aspx) is the same as the Observer pattern: you want to notify other services when certain events take place.</span></span> <span data-ttu-id="5159d-154">Ancak gözlemci ve Pub/Sub desenler arasında önemli bir fark yoktur.</span><span class="sxs-lookup"><span data-stu-id="5159d-154">But there is an important difference between the Observer and Pub/Sub patterns.</span></span> <span data-ttu-id="5159d-155">"Birbirine alışık oldukları için" gözlemci desende yayın gözlemciler için doğrudan observable gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-155">In the observer pattern, the broadcast is performed directly from the observable to the observers, so they “know” each other.</span></span> <span data-ttu-id="5159d-156">Ancak bir Pub/Sub düzeni kullanılırken yayımcı ve abone tarafından bilinen aracısı veya ileti Aracısı ya da olay veri yolu, adlı üçüncü bir bileşen, yoktur.</span><span class="sxs-lookup"><span data-stu-id="5159d-156">But when using a Pub/Sub pattern, there is a third component, called broker or message broker or event bus, which is known by both the publisher and subscriber.</span></span> <span data-ttu-id="5159d-157">Bu nedenle, Pub/Sub düzeni kullanırken, yayımcı ve aboneleri tam olarak belirtilen olay veri yolu veya ileti Aracısı sayesinde birbirinden ayrılmıştır.</span><span class="sxs-lookup"><span data-stu-id="5159d-157">Therefore, when using the Pub/Sub pattern the publisher and the subscribers are precisely decoupled thanks to the mentioned event bus or message broker.</span></span>

### <a name="the-middleman-or-event-bus"></a><span data-ttu-id="5159d-158">Middleman ya da olay veri yolu</span><span class="sxs-lookup"><span data-stu-id="5159d-158">The middleman or event bus</span></span> 

<span data-ttu-id="5159d-159">Yayımcı ile abone arasındaki gizlilik nasıl elde edebilirim?</span><span class="sxs-lookup"><span data-stu-id="5159d-159">How do you achieve anonymity between publisher and subscriber?</span></span> <span data-ttu-id="5159d-160">Kolay bir yolu, tüm iletişimi dikkatli bir middleman izin ' dir.</span><span class="sxs-lookup"><span data-stu-id="5159d-160">An easy way is let a middleman take care of all the communication.</span></span> <span data-ttu-id="5159d-161">Bir olay veri yolu bir middleman ' dir.</span><span class="sxs-lookup"><span data-stu-id="5159d-161">An event bus is one such middleman.</span></span>

<span data-ttu-id="5159d-162">Bir olay veri yolu, genellikle iki bölümden oluşur:</span><span class="sxs-lookup"><span data-stu-id="5159d-162">An event bus is typically composed of two parts:</span></span>

-   <span data-ttu-id="5159d-163">Soyut veya arabirim.</span><span class="sxs-lookup"><span data-stu-id="5159d-163">The abstraction or interface.</span></span>

-   <span data-ttu-id="5159d-164">Bir veya daha fazla uygulamaları.</span><span class="sxs-lookup"><span data-stu-id="5159d-164">One or more implementations.</span></span>

<span data-ttu-id="5159d-165">Şekil 6-19'nasıl bir uygulama açısından bakıldığında, olay veri yolu bir Pub/Sub kanal başka bir şey olduğunu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5159d-165">In Figure 6-19 you can see how, from an application point of view, the event bus is nothing more than a Pub/Sub channel.</span></span> <span data-ttu-id="5159d-166">Bu zaman uyumsuz iletişim uygulamak yol gösterebilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-166">The way you implement this asynchronous communication can vary.</span></span> <span data-ttu-id="5159d-167">Böylece ortamı gereksinimlerini (örneğin, geliştirme ortamları ve üretim) bağlı olarak bunlar arasında değiştirme birden fazla uygulaması sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="5159d-167">It can have multiple implementations so that you can swap between them, depending on the environment requirements (for example, production versus development environments).</span></span>

<span data-ttu-id="5159d-168">Şekil 6-20 RabbitMQ, Azure Service Bus veya başka bir olay/ileti aracısı gibi teknolojileri Mesajlaşma altyapısının temel birden çok uygulama ile bir olay veri yolu bir özeti görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5159d-168">In Figure 6-20 you can see an abstraction of an event bus with multiple implementations based on infrastructure messaging technologies like RabbitMQ, Azure Service Bus, or another event/message broker.</span></span>

![RabbitMQ Azure Service bus veya diğerleri gibi çeşitli tecnologies ile uygulanabilir için bir arabirim ile tanımlanan olay veri yolu uygundur.](./media/image21.png)

<span data-ttu-id="5159d-170">**Şekil 6 - 20.**</span><span class="sxs-lookup"><span data-stu-id="5159d-170">**Figure 6- 20.**</span></span> <span data-ttu-id="5159d-171">Bir olay veri yolu birden fazla uygulaması</span><span class="sxs-lookup"><span data-stu-id="5159d-171">Multiple implementations of an event bus</span></span>

<span data-ttu-id="5159d-172">Ancak ve daha önce bahsedilen olarak kendi soyutlamalar (olay veri yolu arabirimi) kullanarak yalnızca temel olay veri yolu özelliklerinin, soyutlama tarafından desteklenen gerekiyorsa uygundur.</span><span class="sxs-lookup"><span data-stu-id="5159d-172">However, and as mentioned previously, using your own abstractions (the event bus interface) is good only if you need basic event bus features supported by your abstractions.</span></span> <span data-ttu-id="5159d-173">Daha zengin service bus özelliklerine ihtiyacınız varsa, büyük olasılıkla API ve kendi soyutlama yerine, tercih edilen ticari hizmet veri yolu tarafından sağlanan soyutlama kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5159d-173">If you need richer service bus features, you should probably use the API and abstractions provided by your preferred commercial service bus instead of your own abstractions.</span></span>

### <a name="defining-an-event-bus-interface"></a><span data-ttu-id="5159d-174">Bir olay veri yolu arabirim tanımlama</span><span class="sxs-lookup"><span data-stu-id="5159d-174">Defining an event bus interface</span></span>

<span data-ttu-id="5159d-175">Bazı uygulama kodu olay veri yolu arabirimin ve araştırma amacıyla olası uygulamaları ile başlayalım tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5159d-175">Let’s start with some implementation code for the event bus interface and possible implementations for exploration purposes.</span></span> <span data-ttu-id="5159d-176">Arabirimi, genel ve basit arabirim olduğu gibi olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="5159d-176">The interface should be generic and straightforward, as in the following interface.</span></span>

```csharp
public interface IEventBus
{
    void Publish(IntegrationEvent @event);

    void Subscribe<T, TH>()
        where T : IntegrationEvent
        where TH : IIntegrationEventHandler<T>;

    void SubscribeDynamic<TH>(string eventName)
        where TH : IDynamicIntegrationEventHandler;

    void UnsubscribeDynamic<TH>(string eventName)
        where TH : IDynamicIntegrationEventHandler;

    void Unsubscribe<T, TH>()
        where TH : IIntegrationEventHandler<T>
        where T : IntegrationEvent;
}
```

<span data-ttu-id="5159d-177">`Publish` Yöntem basittir.</span><span class="sxs-lookup"><span data-stu-id="5159d-177">The `Publish` method is straightforward.</span></span> <span data-ttu-id="5159d-178">Olay veri yolu, herhangi bir mikro hizmet ya da o olaya abone bile bir dış uygulamaya geçirilen tümleştirme etkinliği yayınlamak.</span><span class="sxs-lookup"><span data-stu-id="5159d-178">The event bus will broadcast the integration event passed to it to any microservice, or even an external application, subscribed to that event.</span></span> <span data-ttu-id="5159d-179">Bu yöntem olayın yayımlanması mikro hizmet tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="5159d-179">This method is used by the microservice that is publishing the event.</span></span>

<span data-ttu-id="5159d-180">`Subscribe` Yöntemleri (bağımsız değişkenler bağlı olarak çeşitli uygulamalar olabilir), olaylar almak istiyorsanız mikro hizmetler tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="5159d-180">The `Subscribe` methods (you can have several implementations depending on the arguments) are used by the microservices that want to receive events.</span></span> <span data-ttu-id="5159d-181">Bu yöntem, iki bağımsız değişkeni vardır.</span><span class="sxs-lookup"><span data-stu-id="5159d-181">This method has two arguments.</span></span> <span data-ttu-id="5159d-182">İlk abone olmak için tümleştirme olaydır (`IntegrationEvent`).</span><span class="sxs-lookup"><span data-stu-id="5159d-182">The first is the integration event to subscribe to (`IntegrationEvent`).</span></span> <span data-ttu-id="5159d-183">Tümleştirme olay işleyici (ya da geri arama yöntemi) adlı ikinci bağımsız değişken olan `IIntegrationEventHandler<T>`, alıcı mikro hizmet, bu tümleştirme olay iletisi aldığında çalıştırılacak.</span><span class="sxs-lookup"><span data-stu-id="5159d-183">The second argument is the integration event handler (or callback method), named `IIntegrationEventHandler<T>`, to be executed when the receiver microservice gets that integration event message.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5159d-184">[Önceki](database-server-container.md)
>[İleri](rabbitmq-event-bus-development-test-environment.md)</span><span class="sxs-lookup"><span data-stu-id="5159d-184">[Previous](database-server-container.md)
[Next](rabbitmq-event-bus-development-test-environment.md)</span></span>