### <a name="avoiding-endless-recursion-for-iworkflowinstancemanagementtransactedcancel-and-iworkflowinstancemanagementtransactedterminate"></a><span data-ttu-id="6c37f-101">Sonsuz özyineleme IWorkflowInstanceManagement.TransactedCancel ve IWorkflowInstanceManagement.TransactedTerminate kaçınma</span><span class="sxs-lookup"><span data-stu-id="6c37f-101">Avoiding endless recursion for IWorkflowInstanceManagement.TransactedCancel and IWorkflowInstanceManagement.TransactedTerminate</span></span>

|   |   |
|---|---|
|<span data-ttu-id="6c37f-102">Ayrıntılar</span><span class="sxs-lookup"><span data-stu-id="6c37f-102">Details</span></span>|<span data-ttu-id="6c37f-103">Kullanırken bazı koşullarda <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedCancel%2A?displayProperty=nameWithType> veya <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedTerminate%2A?displayProperty=nameWithType> iptal veya bir iş akışının sonlandırmak için API'ler hizmet örneği, iş akışı örneği bir yığın taşması nedeniyle sonsuz özyineleme karşılaşabilirsiniz olduğunda <code>Workflow</code> kalıcı hale getirmek çalışma zamanı çalışır istek işlenirken bir parçası olarak hizmet örneği.</span><span class="sxs-lookup"><span data-stu-id="6c37f-103">Under some circumstances when using <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedCancel%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedTerminate%2A?displayProperty=nameWithType> APIs to cancel or terminate a worklow service instance, the workflow instance may encounter a stack overflow due to endless recursion when the <code>Workflow</code> runtime attempts to persist the service instance as part of processing the request.</span></span> <span data-ttu-id="6c37f-104">Sorun iş akışı örneği tamamlamak bazı diğer bekleyen WCF için başka bir hizmete istek burada bekleyen bir durumda ise oluşur. <code>TransactedCancel</code> Ve <code>TransactedTerminate</code> iş akışı hizmet örneği için sıraya alınan iş öğeleri oluşturma işlemleri.</span><span class="sxs-lookup"><span data-stu-id="6c37f-104">The problem occurs if the workflow instance is in a state where it is waiting for some other outstanding WCF request to another service to complete.The <code>TransactedCancel</code> and <code>TransactedTerminate</code> operations create work items that are queued for the workflow service instance.</span></span> <span data-ttu-id="6c37f-105">Bu iş öğeleri işlenmesini bir parçası olarak yürütülmez <code>TransactedCancel/TransactedTerminate</code> isteği.</span><span class="sxs-lookup"><span data-stu-id="6c37f-105">These work items are not executed as part of the processing of the <code>TransactedCancel/TransactedTerminate</code> request.</span></span> <span data-ttu-id="6c37f-106">İş akışı hizmet örneği tamamlamak diğer bekleyen WCF isteği beklerken meşgul olduğu için iş öğesi oluşturuldu kuyruğa alınmış olarak kalır.</span><span class="sxs-lookup"><span data-stu-id="6c37f-106">Because the workflow service instance is busy waiting for the other outstanding WCF request to complete, the work item created remains queued.</span></span> <span data-ttu-id="6c37f-107"><code>TransactedCancel/TransactedTerminate</code> İşlemi tamamlandıktan ve denetim, istemciye döndürülür.</span><span class="sxs-lookup"><span data-stu-id="6c37f-107">The <code>TransactedCancel/TransactedTerminate</code> operation completes and control is returned back to the client.</span></span> <span data-ttu-id="6c37f-108">İşlemin ne zaman ilişkili <code>TransactedCancel/TransactedTerminate</code> tamamlama girişiminde işlemi, bu iş akışı hizmet örneği durumu kalıcı hale getirilmesi.</span><span class="sxs-lookup"><span data-stu-id="6c37f-108">When the transaction associated with the <code>TransactedCancel/TransactedTerminate</code> operation attempts to commit, it needs to persist the workflow serivce instance state.</span></span> <span data-ttu-id="6c37f-109">Ancak yoktur çünkü bir bekleyen <code>WCF</code> istek örneği için iş akışı çalışma zamanı iş akışı hizmet örneği kalıcı yapılamıyor ve bir sonsuz özyineleme döngü için yığın taşması gidiyor. Çünkü <code>TransactedCancel</code> ve <code>TransactedTerminate</code> yalnızca bellekte bir iş öğesi oluşturun, bir işlem var olduğunu olgu herhangi bir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="6c37f-109">But because there is an outstanding <code>WCF</code> request for the instance, the Workflow runtime cannot persist the workflow service instance, and an endless recursion loop leads to the stack overflow.Because <code>TransactedCancel</code> and <code>TransactedTerminate</code> only create a work item in memory, the fact that a transaction exists doesn't have any effect.</span></span> <span data-ttu-id="6c37f-110">Bir geri alma işlemi, iş öğesini atmak değil. .NET Framework 4.7.2, başlayarak, bu sorunu gidermek için hazırladık bir <code>AppSetting</code> için eklenebilir <code>web.config/app.config</code> söyler, işlemler için yoksaymak için iş akışı hizmeti <code>TransactedCancel</code> ve <code>TransactedTerminate</code>.</span><span class="sxs-lookup"><span data-stu-id="6c37f-110">A rollback of the transaction does not discard the work item.To address this issue, starting in .NET Framework 4.7.2, we have introduced an <code>AppSetting</code> that can be added to the <code>web.config/app.config</code> of the workflow service that tells it to ignore transactions for <code>TransactedCancel</code> and <code>TransactedTerminate</code>.</span></span> <span data-ttu-id="6c37f-111">Bu iş akışı örneği kalıcı hale getirmek beklemenize gerek kalmadan yürütme işlemi sağlar. Bu özellik için AppSetting adlı <code>microsoft:WorkflowServices:IgnoreTransactionsForTransactedCancelAndTransactedTerminate</code>.</span><span class="sxs-lookup"><span data-stu-id="6c37f-111">This allows the transaction to commit without waiting for the workflow instance to persist.The AppSetting for this feature is named <code>microsoft:WorkflowServices:IgnoreTransactionsForTransactedCancelAndTransactedTerminate</code>.</span></span> <span data-ttu-id="6c37f-112">Değerini <code>true</code> işlem, bu nedenle yığın taşması önleme yoksayılmalıdır olduğunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="6c37f-112">A value of <code>true</code> indicates that the transaction should be ignored, thus avoiding the stack overflow.</span></span> <span data-ttu-id="6c37f-113">Bu uygulama ayarı varsayılan değeri <code>false</code>, mevcut iş akışı hizmet örneklerine etkilenmez.</span><span class="sxs-lookup"><span data-stu-id="6c37f-113">The default value of this AppSetting is <code>false</code>, so existing workflow service instances are not affected.</span></span>|
|<span data-ttu-id="6c37f-114">Öneri</span><span class="sxs-lookup"><span data-stu-id="6c37f-114">Suggestion</span></span>|<span data-ttu-id="6c37f-115">AppFabric veya başka bir kullanıyorsanız <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement> istemci ve bu iş akışı hizmet örneği yığın taşmasına iptal veya bir iş akışı örneği sonlandırmak çalışırken karşılaşıldığında, şu şekilde ekleyebilirsiniz <code>&lt;appSettings&gt;</code> web.config/ Bölümü İş akışı hizmeti için app.config dosyasında:</span><span class="sxs-lookup"><span data-stu-id="6c37f-115">If you are using AppFabric or another <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement> client and are encountering a stack overflow in the workflow serivce instance when trying to cancel or terminate a workflow instance, you can add the following to the <code>&lt;appSettings&gt;</code> section of the web.config/app.config file for the workflow service:</span></span><pre><code class="lang-xml">&lt;add key=&quot;microsoft:WorkflowServices:IgnoreTransactionsForTransactedCancelAndTransactedTerminate&quot; value=&quot;true&quot;/&gt;&#13;&#10;</code></pre><span data-ttu-id="6c37f-116">Sorun karşılaşılıyorsa değil, bunu yapmak gerekmez.</span><span class="sxs-lookup"><span data-stu-id="6c37f-116">If you are not encountering the problem, you do not need to do this.</span></span>|
|<span data-ttu-id="6c37f-117">Kapsam</span><span class="sxs-lookup"><span data-stu-id="6c37f-117">Scope</span></span>|<span data-ttu-id="6c37f-118">Kenar</span><span class="sxs-lookup"><span data-stu-id="6c37f-118">Edge</span></span>|
|<span data-ttu-id="6c37f-119">Sürüm</span><span class="sxs-lookup"><span data-stu-id="6c37f-119">Version</span></span>|<span data-ttu-id="6c37f-120">4.7.2</span><span class="sxs-lookup"><span data-stu-id="6c37f-120">4.7.2</span></span>|
|<span data-ttu-id="6c37f-121">Tür</span><span class="sxs-lookup"><span data-stu-id="6c37f-121">Type</span></span>|<span data-ttu-id="6c37f-122">Yeniden hedefleme</span><span class="sxs-lookup"><span data-stu-id="6c37f-122">Retargeting</span></span>|

